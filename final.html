<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Vietnam History discussions on Stack Exchange History</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="final_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_files/libs/quarto-html/quarto.js"></script>
<script src="final_files/libs/quarto-html/popper.min.js"></script>
<script src="final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Vietnam History discussions on Stack Exchange History</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="student-information" class="level2">
<h2 class="anchored" data-anchor-id="student-information">Student information</h2>
<p><strong>Task:</strong> 8HD - Data Cleansing and Text Analysis Challenge</p>
<p><strong>Name:</strong> Hoang Long Tran</p>
<p><strong>ID:</strong> 223128143</p>
<p><strong>Email:</strong> s223128143@deakin.edu.au</p>
<p><strong>Undergraduate:</strong> SIT220</p>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<section id="importing-the-libraries" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-libraries">Importing the libraries</h3>
<div id="68765d4f" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing all the libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'stopwords'</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'punkt'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">'wordnet'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Image, display, HTML, clear_output</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> folium</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> openai</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sentence_transformers <span class="im">import</span> SentenceTransformer</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bertopic <span class="im">import</span> BERTopic</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bertopic.representation <span class="im">import</span> KeyBERTInspired, MaximalMarginalRelevance, OpenAI, PartOfSpeech</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\tomde\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to
[nltk_data]     C:\Users\tomde\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     C:\Users\tomde\AppData\Roaming\nltk_data...
[nltk_data]   Package wordnet is already up-to-date!</code></pre>
</div>
</div>
</section>
<section id="export-xml-to-csv" class="level3">
<h3 class="anchored" data-anchor-id="export-xml-to-csv">Export <code>XML</code> to <code>csv</code></h3>
<p>StackExchange uses <code>XML</code> file, so we would need to convert them to <code>csv</code> for easier use.</p>
<pre><code>&lt;row&gt;
    &lt;name&gt;John&lt;/name&gt;
    &lt;age&gt;30&lt;/age&gt;
    &lt;city&gt;New York&lt;/city&gt;
&lt;/row&gt;</code></pre>
<ul>
<li><strong>Elements</strong>: parent element is <code>&lt;row&gt;</code>. Child element is <code>&lt;name&gt;</code>, <code>&lt;age&gt;</code> and <code>&lt;city&gt;</code>.Each child element contains text content or attributes of the record.</li>
<li><strong>Tag</strong>: a tag has 2 part, opening <code>&lt;row&gt;</code> and closing <code>&lt;/row&gt;</code>. There are 4 tag in this case, <code>&lt;row&gt;</code> <code>&lt;/row&gt;</code> are tags representing parent element, <code>&lt;name&gt;</code> <code>&lt;/name</code>&gt;, <code>&lt;age&gt;</code> <code>&lt;/age&gt;</code>, <code>&lt;city</code>&gt; <code>&lt;/city&gt;</code> are children tags.</li>
<li><strong>Event</strong>: events are points where the parser execute actions like extracting data or processing elements.</li>
</ul>
<div id="500a4c9b" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> xml_to_df(xml_file, tag):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Parse XML file iteratively via tag and output dictionary. Each dictionary is a data from XML row.   </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    context <span class="op">=</span> etree.iterparse(xml_file, events<span class="op">=</span>(<span class="st">'end'</span>,), tag<span class="op">=</span>tag) <span class="co"># the event starts parsing the end of a tag</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> event, element <span class="kw">in</span> context:</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        record <span class="op">=</span> {child.tag: child.text <span class="cf">for</span> child <span class="kw">in</span> element} <span class="co"># loop through the child element</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        record.update(element.attrib) <span class="co"># update text content of child element</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> record <span class="co"># return the dictionary and not holding in memory</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Clear the element to free up space</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        element.clear()</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # Badges</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Badges.xml'</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># data_tag = 'row'</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Badges = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Badges.to_csv('Badges.csv', index=False)</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # Comments</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Comments.xml'</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments.to_csv('Comments.csv', index=False)</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # PostHistory</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'PostHistory.xml'</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('PostHistory.csv', index=False)</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # Postlinks</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Postlinks.xml'</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Postlinks.csv', index=False)</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # PostHistory</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Postlinks.xml'</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Postlinks.csv', index=False)</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # Posts</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Posts.xml'</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Posts.csv', index=False)</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a><span class="co"># # Tags</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Tags.xml'</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Tags.csv', index=False)</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="co"># # Users</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Users.xml'</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Users.csv', index=False)</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="co"># # Votes</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="co"># xml_file = 'Votes.xml'</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory = pd.DataFrame(xml_to_df(xml_file, data_tag))</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a><span class="co"># PostHistory.to_csv('Votes.csv', index=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To export a <code>xml</code> file, I use a function that parse XML file iteratively via tag and outputing a dictionary. Each dictionary is a data from XML row.</p>
</section>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<p>I will only be using the <code>Post</code>, <code>Comment</code> and <code>User</code> csv</p>
<div id="cb0c5f86" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Comments <span class="op">=</span> pd.read_csv(<span class="st">'Comments.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Posts <span class="op">=</span> pd.read_csv(<span class="st">'Posts.csv'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Users <span class="op">=</span> pd.read_csv(<span class="st">'Users.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="group-post-and-comments-dataset" class="level3">
<h3 class="anchored" data-anchor-id="group-post-and-comments-dataset">Group <code>Post</code> and <code>Comments</code> dataset</h3>
<div id="2a671326" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the two dataframes</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.merge(Posts, Comments, left_on<span class="op">=</span><span class="st">'Id'</span>, right_on <span class="op">=</span> <span class="st">'PostId'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-arange the columns</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df1.drop([<span class="st">'PostId'</span>, <span class="st">'Score_y'</span>, <span class="st">'Score_x'</span>, <span class="st">'CreationDate_y'</span>, <span class="st">'ClosedDate'</span>, <span class="st">'ParentId'</span>, <span class="st">'FavoriteCount'</span>, <span class="st">'LastEditorDisplayName'</span>, <span class="st">'CommunityOwnedDate'</span>, <span class="st">'Id_y'</span>, <span class="st">'Score_y'</span>, <span class="st">'LastEditorUserId'</span>, <span class="st">'CreationDate_y'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df2.rename({<span class="st">'Id_x'</span>:<span class="st">'PostId'</span>, <span class="st">'CreationDate_x'</span>:<span class="st">'CreationDate'</span>, <span class="st">'Body'</span>:<span class="st">'Post'</span>, <span class="st">'Text'</span>:<span class="st">'Comment'</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">'UserId'</span>:<span class="st">'UserCommentId'</span>, <span class="st">'OwnerUserId'</span>:<span class="st">'PostUserId'</span>}, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2[[<span class="st">'PostId'</span>, <span class="st">'Post'</span>, <span class="st">'PostUserId'</span>, <span class="st">'Comment'</span>, <span class="st">'UserCommentId'</span>, <span class="st">'CreationDate'</span>, <span class="st">'LastActivityDate'</span>, <span class="st">'Tags'</span>]] <span class="co"># Choosing specific columns</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>display(df2.head(), df2.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post</th>
<th data-quarto-table-cell-role="th">PostUserId</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">UserCommentId</th>
<th data-quarto-table-cell-role="th">CreationDate</th>
<th data-quarto-table-cell-role="th">LastActivityDate</th>
<th data-quarto-table-cell-role="th">Tags</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>&lt;p&gt;What factors related to the Eastern Crisis ...</td>
<td>14.0</td>
<td>Please elaborate a bit on "Eastern Crisis". I ...</td>
<td>10.0</td>
<td>2011-10-11T19:30:14.017</td>
<td>2013-08-19T18:04:54.217</td>
<td>|20th-century|world-war-one|</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>&lt;p&gt;What factors related to the Eastern Crisis ...</td>
<td>14.0</td>
<td>Some elaboration would be handy. This question...</td>
<td>20.0</td>
<td>2011-10-11T19:30:14.017</td>
<td>2013-08-19T18:04:54.217</td>
<td>|20th-century|world-war-one|</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>&lt;p&gt;What factors related to the Eastern Crisis ...</td>
<td>14.0</td>
<td>Seconding the request for elaboration on what ...</td>
<td>12.0</td>
<td>2011-10-11T19:30:14.017</td>
<td>2013-08-19T18:04:54.217</td>
<td>|20th-century|world-war-one|</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>&lt;p&gt;What factors related to the Eastern Crisis ...</td>
<td>14.0</td>
<td>Congrats on the first question of the site. ha.</td>
<td>16.0</td>
<td>2011-10-11T19:30:14.017</td>
<td>2013-08-19T18:04:54.217</td>
<td>|20th-century|world-war-one|</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>&lt;p&gt;What factors related to the Eastern Crisis ...</td>
<td>14.0</td>
<td>Thanks. I thought there was something wrong wi...</td>
<td>14.0</td>
<td>2011-10-11T19:30:14.017</td>
<td>2013-08-19T18:04:54.217</td>
<td>|20th-century|world-war-one|</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>(150384, 8)</code></pre>
</div>
</div>
<p>After grouping the datasets, we can see that the tags column allows us to filter out things related to our topic</p>
</section>
<section id="filtered-out-topics-via-tags-column" class="level3">
<h3 class="anchored" data-anchor-id="filtered-out-topics-via-tags-column">Filtered out topics via <code>Tags</code> column</h3>
<p>I am interested in this column because it allows me to filter out tags related to <code>vietnam war</code>.</p>
<div id="e4fb5668" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN values in `Tags` column with empty string</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">'Tags'</span>] <span class="op">=</span> df2[<span class="st">'Tags'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df2.loc[df2.Tags.<span class="bu">str</span>.contains(<span class="st">'(?:vietnam[^|]+)|indochina|vietnam'</span>, regex<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2.Tags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>704            |20th-century|war|united-states|vietnam-war|
3285      |20th-century|military|war|civil-war|vietnam-war|
3286      |20th-century|military|war|civil-war|vietnam-war|
4836      |world-war-two|france|french-empire|vietnam|in...
4837      |world-war-two|france|french-empire|vietnam|in...
                                ...                        
148728                       |vietnam-war|symbols|protests|
148729                       |vietnam-war|symbols|protests|
148730                       |vietnam-war|symbols|protests|
148731                       |vietnam-war|symbols|protests|
149016                                            |vietnam|
Name: Tags, Length: 300, dtype: object</code></pre>
</div>
</div>
<p>Explanation of regex <code>(?:vietnam[^,]+)|vietnam</code> - <code>(?:)</code> - non-capturing group to not capture matched text separately</p>
<ul>
<li><p><code>vietnam[^,]+</code> - matches the string <code>vietnam</code> and one or more characters that are not commas</p></li>
<li><p><code>|vietnam</code> - or <code>vietnam</code></p></li>
<li><p><code>|indochina</code> - or <code>indochina</code></p></li>
</ul>
<p>In essence I am trying to capture ‘vietnam-war’, ‘vietnam’ and ‘indochina’</p>
</section>
<section id="add-the-users-dataset-to-our-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="add-the-users-dataset-to-our-dataframe">Add the <code>Users</code> dataset to our dataframe</h3>
<div id="00b1f4c1" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df2.copy()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df3[[<span class="st">'PostId'</span>, <span class="st">'Post'</span>, <span class="st">'PostUserId'</span>, <span class="st">'Comment'</span>, <span class="st">'UserCommentId'</span>, <span class="st">'CreationDate'</span>, <span class="st">'LastActivityDate'</span>]] <span class="co"># Choosing specific columns</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.merge(df3, Users, left_on<span class="op">=</span><span class="st">'UserCommentId'</span>, right_on <span class="op">=</span> <span class="st">'Id'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df3.rename({<span class="st">'CreationDate_x'</span>:<span class="st">'CreationDate'</span>, <span class="st">'Location'</span>:<span class="st">'UserCommentLocation'</span>, <span class="st">'DisplayName'</span>:<span class="st">'UserCommentName'</span>} ,inplace<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN rows in location. user name column with empty string</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>df3.loc[:, [<span class="st">'UserCommentLocation'</span>, <span class="st">'UserCommentName'</span>, <span class="st">'Comment'</span>]] <span class="op">=</span> df3.loc[:, [<span class="st">'UserCommentLocation'</span>, <span class="st">'UserCommentName'</span>, <span class="st">'Comment'</span>]].fillna(<span class="st">''</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose only a few column from Users dataset</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df3[[<span class="st">'PostId'</span>, <span class="st">'Post'</span>, <span class="st">'PostUserId'</span>, <span class="st">'Comment'</span>, <span class="st">'UserCommentId'</span>, <span class="st">'CreationDate'</span>, <span class="st">'LastActivityDate'</span>, <span class="st">'UserCommentName'</span>, <span class="st">'UserCommentLocation'</span>]]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>display(df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post</th>
<th data-quarto-table-cell-role="th">PostUserId</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">UserCommentId</th>
<th data-quarto-table-cell-role="th">CreationDate</th>
<th data-quarto-table-cell-role="th">LastActivityDate</th>
<th data-quarto-table-cell-role="th">UserCommentName</th>
<th data-quarto-table-cell-role="th">UserCommentLocation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>229</td>
<td>&lt;p&gt;What happened in the aftermath of the Tet o...</td>
<td>103.0</td>
<td></td>
<td>NaN</td>
<td>2011-10-13T08:12:44.507</td>
<td>2012-02-13T12:55:43.963</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>991</td>
<td>&lt;p&gt;South Vietnam was helped by US. Even when t...</td>
<td>338.0</td>
<td>The South was invaded in a regular war by the ...</td>
<td>103.0</td>
<td>2011-12-17T04:51:31.127</td>
<td>2023-01-17T06:19:46.630</td>
<td>Sardathrion - against SE abuse</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>991</td>
<td>&lt;p&gt;South Vietnam was helped by US. Even when t...</td>
<td>338.0</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>13404.0</td>
<td>2011-12-17T04:51:31.127</td>
<td>2023-01-17T06:19:46.630</td>
<td>user3847</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1466</td>
<td>&lt;p&gt;After WWII France was in rebuilding mode, a...</td>
<td>579.0</td>
<td>Did you actually try to find some answer yours...</td>
<td>102.0</td>
<td>2012-02-24T05:32:20.690</td>
<td>2021-08-24T16:28:48.823</td>
<td>o0'.</td>
<td>.:…·•°</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1466</td>
<td>&lt;p&gt;After WWII France was in rebuilding mode, a...</td>
<td>579.0</td>
<td>I did some searching, but as far as I could fi...</td>
<td>579.0</td>
<td>2012-02-24T05:32:20.690</td>
<td>2021-08-24T16:28:48.823</td>
<td>ihtkwot</td>
<td>Chicago, IL, United States</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">295</td>
<td>72940</td>
<td>&lt;p&gt;I have &lt;a href="https://designobserver.com/...</td>
<td>63445.0</td>
<td>I was very much alive back then. but I never s...</td>
<td>4225.0</td>
<td>2023-12-09T19:15:28.820</td>
<td>2023-12-09T21:23:49.380</td>
<td>fdb</td>
<td>Cambridge</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">296</td>
<td>72940</td>
<td>&lt;p&gt;I have &lt;a href="https://designobserver.com/...</td>
<td>63445.0</td>
<td>Likewise, I was well aware what was going on b...</td>
<td>27140.0</td>
<td>2023-12-09T19:15:28.820</td>
<td>2023-12-09T21:23:49.380</td>
<td>Jos</td>
<td>Krung Thep Mahanakhon Amon Rattanakosin Mahint...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">297</td>
<td>72940</td>
<td>&lt;p&gt;I have &lt;a href="https://designobserver.com/...</td>
<td>63445.0</td>
<td>There are oodles of pictures of Vietnam war pr...</td>
<td>771.0</td>
<td>2023-12-09T19:15:28.820</td>
<td>2023-12-09T21:23:49.380</td>
<td>T.E.D.</td>
<td>Tulsa, Oklahoma</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">298</td>
<td>72940</td>
<td>&lt;p&gt;I have &lt;a href="https://designobserver.com/...</td>
<td>63445.0</td>
<td>Maybe this I guess? https://www.gettyimages.co...</td>
<td>3011.0</td>
<td>2023-12-09T19:15:28.820</td>
<td>2023-12-09T21:23:49.380</td>
<td>Brian Z</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">299</td>
<td>74079</td>
<td>&lt;p&gt;How did Vietnamese era names work before th...</td>
<td>62465.0</td>
<td></td>
<td>NaN</td>
<td>2023-12-31T11:19:55.273</td>
<td>2023-12-31T14:28:13.690</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>300 rows × 9 columns</p>
</div>
</div>
</div>
</div>
<p>I might use data from the <code>Users</code> dataset later, so I will just grab the <code>PostUserId</code> and <code>UserCommentId</code> from it.</p>
</section>
<section id="convert-the-post-and-comment-columns-to-string-for-investigation" class="level3">
<h3 class="anchored" data-anchor-id="convert-the-post-and-comment-columns-to-string-for-investigation">Convert the <code>Post</code> and <code>Comment</code> columns to string for investigation</h3>
<p>I will convert the rows of these two columns into string to look out for things to filter out using regex. I will be building my regex on <code>https://regex101.com/</code>.</p>
<div id="f85ee5fb" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>post_string <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(df3.drop_duplicates(<span class="st">'Post'</span>).Post).lower()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>comment_string <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(df3.Comment).lower()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>display(post_string[:<span class="dv">100</span>], comment_string[:<span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>'&lt;p&gt;what happened in the aftermath of the tet offensive to the viet cong?  was it actually broken or '</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>"\nthe south was invaded in a regular war by the north.\ni'll forego a lengthy analysis and simply reco"</code></pre>
</div>
</div>
</section>
<section id="remove-html-tags-from-post-and-comment-column" class="level3">
<h3 class="anchored" data-anchor-id="remove-html-tags-from-post-and-comment-column">Remove <code>HTML</code> tags from <code>Post</code> and <code>Comment</code> column</h3>
<div id="ba82398b" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(re.findall(<span class="st">'&lt;.*?&gt;'</span>, df3.Post[<span class="dv">109</span>]))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_html(text):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.sub(<span class="st">'\&lt;.*?&gt;'</span>, <span class="st">''</span>, text) <span class="co"># replace matching substrings with a new string for all occurrences</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">'Post'</span>] <span class="op">=</span> df3[<span class="st">'Post'</span>].<span class="bu">apply</span>(remove_html) </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">'Comment'</span>] <span class="op">=</span> df3[<span class="st">'Comment'</span>].<span class="bu">apply</span>(remove_html) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['&lt;p&gt;', '&lt;/p&gt;', '&lt;ol&gt;', '&lt;li&gt;', '&lt;/li&gt;', '&lt;li&gt;', '&lt;/li&gt;', '&lt;/ol&gt;', '&lt;p&gt;', '&lt;/p&gt;', '&lt;p&gt;', '&lt;/p&gt;', '&lt;p&gt;', '&lt;/p&gt;']</code></pre>
</div>
</div>
<p>Explanation of regex <code>&lt;.*?&gt;</code></p>
<ul>
<li><p><code>&lt;&gt;</code> - initializer of html paragraph</p></li>
<li><p><code>.*?</code> - lazy quantifer to match any character between zero and unlimited times, as few as possible</p></li>
</ul>
</section>
<section id="remove-links-and-from-comments-column" class="level3">
<h3 class="anchored" data-anchor-id="remove-links-and-from-comments-column">Remove <code>links</code> and <code>[]</code> from <code>Comments</code> column</h3>
<div id="9cc03ece" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regex patterns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bracket_pattern <span class="op">=</span> <span class="st">'\[(?:[^\[\]]+)\]'</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>link_pattern <span class="op">=</span> <span class="st">'(?:http\S+)'</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example display</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>display(re.findall(link_pattern, df3[<span class="st">'Comment'</span>][<span class="dv">298</span>]))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>display(re.findall(bracket_pattern, df3[<span class="st">'Comment'</span>][<span class="dv">50</span>]))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove those patterns</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">'Comment'</span>] <span class="op">=</span> df3[<span class="st">'Comment'</span>].replace({bracket_pattern: <span class="st">''</span>, link_pattern: <span class="st">''</span>}, regex<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>['https://www.gettyimages.com/detail/news-photo/printed-in-1968-by-students-at-the-rhode-island-school-of-news-photo/524559714']</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>['[wikipedia]']</code></pre>
</div>
</div>
<p>Explanation of regex <code>\[(?:[^\[\]]+)\]</code>’</p>
<ul>
<li><p>Find anything in []</p></li>
<li><p>Since <code>[]</code> exist in regex, we need <code>\</code> before it.</p></li>
<li><p><code>(?:[^\[\]]+)</code> - Non capturing group of one or more matched character except <code>\[\]</code></p></li>
</ul>
<p>Explanation of regex <code>(?:http\S+)</code></p>
<ul>
<li>Non capturing group <code>http</code> and <code>\S+</code> means matches any non-whitespace character</li>
</ul>
</section>
<section id="remove-from-comment-columns" class="level3">
<h3 class="anchored" data-anchor-id="remove-from-comment-columns">Remove <code>@</code> from <code>Comment</code> columns</h3>
<div id="9c393273" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>re.findall(<span class="vs">r'@[^ ]+'</span>, df3.Comment[<span class="dv">47</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df3[<span class="st">'Comment'</span>] <span class="op">=</span> df3[<span class="st">'Comment'</span>].<span class="bu">str</span>.replace(<span class="vs">r'@[^ ]+'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Explanation of regex <code>@[^ ]+</code>:</p>
<ul>
<li>Remove any characters starting with <code>@</code> except white space</li>
</ul>
</section>
<section id="convert-date-columns-to-date-type" class="level3">
<h3 class="anchored" data-anchor-id="convert-date-columns-to-date-type">Convert date columns to date type</h3>
<div id="ec4b92f0" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df4 <span class="op">=</span> df3.copy()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'CreationDate'</span>] <span class="op">=</span> pd.to_datetime(df4[<span class="st">'CreationDate'</span>]) </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'LastActivityDate'</span>] <span class="op">=</span> pd.to_datetime(df4[<span class="st">'LastActivityDate'</span>]) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>display(df4.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 300 entries, 0 to 299
Data columns (total 9 columns):
 #   Column               Non-Null Count  Dtype         
---  ------               --------------  -----         
 0   PostId               300 non-null    int64         
 1   Post                 300 non-null    object        
 2   PostUserId           281 non-null    float64       
 3   Comment              300 non-null    object        
 4   UserCommentId        277 non-null    float64       
 5   CreationDate         300 non-null    datetime64[ns]
 6   LastActivityDate     300 non-null    datetime64[ns]
 7   UserCommentName      300 non-null    object        
 8   UserCommentLocation  300 non-null    object        
dtypes: datetime64[ns](2), float64(2), int64(1), object(4)
memory usage: 21.2+ KB</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>None</code></pre>
</div>
</div>
<p>These columns are useful when plotting the time series graph.</p>
</section>
<section id="create-new-columns-to-remove-stop-words-and-punctuation.-use-in-finding-the-most-common-words." class="level3">
<h3 class="anchored" data-anchor-id="create-new-columns-to-remove-stop-words-and-punctuation.-use-in-finding-the-most-common-words.">Create new columns to remove <code>stop words</code> and <code>punctuation</code>. Use in finding the most common words.</h3>
<section id="remove-punctuation" class="level4">
<h4 class="anchored" data-anchor-id="remove-punctuation">Remove <code>punctuation</code></h4>
<div id="d5f3e8af" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>display(re.findall(<span class="st">'[^\w\s]|[0-9]|[_]'</span>, df4.Post[<span class="dv">0</span>]))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_punctuation(text):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.sub(<span class="st">'[^\w\s]|[0-9]|[_]'</span>, <span class="st">''</span>, text) <span class="co"># replace matching substrings with a new string for all occurrences</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Post2'</span>] <span class="op">=</span> df4[<span class="st">'Post'</span>].<span class="bu">apply</span>(remove_punctuation)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Comment2'</span>] <span class="op">=</span> df4[<span class="st">'Comment'</span>].<span class="bu">apply</span>(remove_punctuation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>['?', '?', ':', '.', '.', '.', '.', '?', '/', '?', '-', '-', ',', '.']</code></pre>
</div>
</div>
<p>Regex explanation <code>[^\w\s]|[0-9]|[_]</code></p>
<ul>
<li><p><code>\w</code> - matches any word character</p></li>
<li><p><code>\s</code> - matches any whitespace character</p></li>
<li><p><code>[^\w\s]</code> - matches any character except for any word character and any whitespace character</p></li>
<li><p><code>[0-9]</code> - matches any digits from 0 to 9</p></li>
<li><p><code>[_]</code> - matches any <code>_</code></p></li>
<li><p><code>|</code> - or statement</p></li>
</ul>
</section>
<section id="remove-stop-words" class="level4">
<h4 class="anchored" data-anchor-id="remove-stop-words">Remove <code>stop words</code></h4>
<p>I am using the NLTK libraries to find english stop words and remove them.</p>
<div id="fbf36b51" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_stopwords(text):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize text: to break individual words into string</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> word_tokenize(text) </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get stopwords</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">'english'</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove stopwords</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    filtered_tokens <span class="op">=</span> [word <span class="cf">for</span> word <span class="kw">in</span> tokens <span class="cf">if</span> word.lower() <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reconstruct the text</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    filtered_text <span class="op">=</span> <span class="st">' '</span>.join(filtered_tokens)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> filtered_text</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Post2'</span>] <span class="op">=</span> df4[<span class="st">'Post2'</span>].<span class="bu">apply</span>(remove_stopwords)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Comment2'</span>] <span class="op">=</span> df4[<span class="st">'Comment2'</span>].<span class="bu">apply</span>(remove_stopwords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="create-new-columns-for-lemmatization.-use-in-sentiment-analysis-topic-modeling-and-information-retrieval" class="level3">
<h3 class="anchored" data-anchor-id="create-new-columns-for-lemmatization.-use-in-sentiment-analysis-topic-modeling-and-information-retrieval">Create new columns for <code>Lemmatization</code>. Use in sentiment analysis, topic modeling, and information retrieval</h3>
<p>To lemmatize a word means to reduce the words back to its root form.</p>
<div id="ab4ae8ca" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the English language model in spaCy</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"en_core_web_sm"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lemmatize text function</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lemmatize_text_spacy(text):</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    lemmatized_text <span class="op">=</span> <span class="st">" "</span>.join([token.lemma_ <span class="cf">for</span> token <span class="kw">in</span> doc])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lemmatized_text</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Post3'</span>] <span class="op">=</span> df4[<span class="st">'Post'</span>].<span class="bu">apply</span>(lemmatize_text_spacy)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>df4[<span class="st">'Comment3'</span>] <span class="op">=</span> df4[<span class="st">'Comment'</span>].<span class="bu">apply</span>(lemmatize_text_spacy)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>display(df4.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post</th>
<th data-quarto-table-cell-role="th">PostUserId</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">UserCommentId</th>
<th data-quarto-table-cell-role="th">CreationDate</th>
<th data-quarto-table-cell-role="th">LastActivityDate</th>
<th data-quarto-table-cell-role="th">UserCommentName</th>
<th data-quarto-table-cell-role="th">UserCommentLocation</th>
<th data-quarto-table-cell-role="th">Post2</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">Comment3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>229</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>103.0</td>
<td></td>
<td>NaN</td>
<td>2011-10-13 08:12:44.507</td>
<td>2012-02-13 12:55:43.963</td>
<td></td>
<td></td>
<td>happened aftermath Tet offensive Viet Cong act...</td>
<td></td>
<td>what happen in the aftermath of the Tet offens...</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>991</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>338.0</td>
<td>The South was invaded in a regular war by the ...</td>
<td>103.0</td>
<td>2011-12-17 04:51:31.127</td>
<td>2023-01-17 06:19:46.630</td>
<td>Sardathrion - against SE abuse</td>
<td></td>
<td>South Vietnam helped US Even US gone million a...</td>
<td>South invaded regular war North</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>the South be invade in a regular war by the No...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>991</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>338.0</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>13404.0</td>
<td>2011-12-17 04:51:31.127</td>
<td>2023-01-17 06:19:46.630</td>
<td>user3847</td>
<td></td>
<td>South Vietnam helped US Even US gone million a...</td>
<td>Ill forego lengthy analysis simply recommend b...</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>I will forego a lengthy analysis and simply re...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1466</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>579.0</td>
<td>Did you actually try to find some answer yours...</td>
<td>102.0</td>
<td>2012-02-24 05:32:20.690</td>
<td>2021-08-24 16:28:48.823</td>
<td>o0'.</td>
<td>.:…·•°</td>
<td>WWII France rebuilding mode yet insisted tryin...</td>
<td>actually try find answer asking</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>do you actually try to find some answer yourse...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1466</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>579.0</td>
<td>I did some searching, but as far as I could fi...</td>
<td>579.0</td>
<td>2012-02-24 05:32:20.690</td>
<td>2021-08-24 16:28:48.823</td>
<td>ihtkwot</td>
<td>Chicago, IL, United States</td>
<td>WWII France rebuilding mode yet insisted tryin...</td>
<td>searching far could find French interested rec...</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>I do some searching , but as far as I could fi...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
</section>
<section id="general-analysis" class="level2">
<h2 class="anchored" data-anchor-id="general-analysis">General Analysis</h2>
<p>General analysis is just looking the text on the surface. I will just be looking at the most common words from <code>Post</code> and <code>Comments</code>. Also, I will look for the trend of the most popular words among the two columns.</p>
<section id="most-common-words-in-post" class="level3">
<h3 class="anchored" data-anchor-id="most-common-words-in-post">Most common words in <code>Post</code></h3>
<p>Find the most common 30 words in a list of tuples</p>
<div id="3e31d858" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `Post2` column into string and lower case</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>post_string <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(df4.drop_duplicates(<span class="st">'Post2'</span>).Post2).lower()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize string into words</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>tokens <span class="op">=</span> word_tokenize(post_string)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the word frequencies</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>word_freq <span class="op">=</span> Counter(tokens)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the most common words</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>top30words <span class="op">=</span> word_freq.most_common(<span class="dv">30</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>display(top30words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>[('vietnam', 128),
 ('war', 91),
 ('would', 53),
 ('us', 48),
 ('vietnamese', 45),
 ('north', 36),
 ('know', 29),
 ('south', 28),
 ('one', 25),
 ('military', 25),
 ('could', 24),
 ('name', 24),
 ('era', 20),
 ('like', 19),
 ('also', 19),
 ('american', 19),
 ('think', 18),
 ('article', 17),
 ('china', 17),
 ('much', 16),
 ('wikipedia', 16),
 ('end', 15),
 ('find', 15),
 ('time', 15),
 ('france', 14),
 ('people', 14),
 ('bob', 14),
 ('question', 13),
 ('im', 13),
 ('government', 13)]</code></pre>
</div>
</div>
<p>Generate a <strong>word cloud</strong> of the list of tuples</p>
<div id="452d667d" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list of tuples into a dictionary</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>top30words <span class="op">=</span> <span class="bu">dict</span>(top30words)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a word cloud</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">'white'</span>).generate_from_frequencies(top30words)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the word cloud</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/cell-17-output-1.png" width="758" height="389" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So the most common words related to Vietnam History in <code>Post</code> are: <strong>vietnam, us, war, north, south, american, france</strong></p>
</section>
<section id="most-common-words-in-comment" class="level3">
<h3 class="anchored" data-anchor-id="most-common-words-in-comment">Most common words in <code>Comment</code></h3>
<p>Find the most common 30 words in a list of tuples</p>
<div id="6a420fcf" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `Comment2` column into string and lower case</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>comment_string <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(df4.Comment2).lower()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize string of words</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>tokens <span class="op">=</span> word_tokenize(comment_string)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the word frequencies</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>word_freq <span class="op">=</span> Counter(tokens)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the most common words</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>top30words <span class="op">=</span> word_freq.most_common(<span class="dv">30</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>display(top30words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>[('question', 75),
 ('vietnam', 73),
 ('would', 63),
 ('war', 61),
 ('us', 46),
 ('answer', 30),
 ('like', 28),
 ('french', 27),
 ('im', 24),
 ('one', 22),
 ('also', 21),
 ('military', 21),
 ('think', 20),
 ('even', 19),
 ('history', 18),
 ('china', 18),
 ('good', 17),
 ('dont', 17),
 ('may', 16),
 ('time', 16),
 ('used', 16),
 ('find', 15),
 ('could', 15),
 ('well', 15),
 ('people', 15),
 ('might', 15),
 ('seems', 15),
 ('comments', 15),
 ('want', 14),
 ('france', 14)]</code></pre>
</div>
</div>
<p>Generate a <strong>word cloud</strong> of the list of tuples</p>
<div id="37dba3be" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `Comment2` column into string and lower case</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list of tuples into a dictionary</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>top30words <span class="op">=</span> <span class="bu">dict</span>(top30words)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a word cloud</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(width<span class="op">=</span><span class="dv">800</span>, height<span class="op">=</span><span class="dv">400</span>, background_color<span class="op">=</span><span class="st">'white'</span>).generate_from_frequencies(top30words)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the word cloud</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud, interpolation<span class="op">=</span><span class="st">'bilinear'</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/cell-19-output-1.png" width="758" height="389" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So the most common words related to Vietnam History in <code>Comment</code> are: <strong>vietnam, us, war, french, china, france</strong></p>
</section>
<section id="trend-analysis-of-common-words-overtime" class="level3">
<h3 class="anchored" data-anchor-id="trend-analysis-of-common-words-overtime">Trend analysis of common words overtime</h3>
<p>The following code blocks will be breaking down the steps I used to plot the time series graph for the most popular words from the posts and comments. #### Replace duplicated rows of <code>Post2</code> column with empty string</p>
<div id="13c9f487" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> df4.copy()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df5.set_index(<span class="st">'CreationDate'</span>, inplace<span class="op">=</span><span class="va">True</span>) <span class="co"># Set 'CreationDate' as the index</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify duplicate rows except for the first occurrence</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>duplicates <span class="op">=</span> df5.duplicated(subset<span class="op">=</span>[<span class="st">'Post2'</span>], keep<span class="op">=</span><span class="st">'first'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Replaced duplicated content with empty strings</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>df5.loc[duplicates, :] <span class="op">=</span> <span class="st">''</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>df5.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post</th>
<th data-quarto-table-cell-role="th">PostUserId</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">UserCommentId</th>
<th data-quarto-table-cell-role="th">LastActivityDate</th>
<th data-quarto-table-cell-role="th">UserCommentName</th>
<th data-quarto-table-cell-role="th">UserCommentLocation</th>
<th data-quarto-table-cell-role="th">Post2</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">Comment3</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CreationDate</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2011-10-13 08:12:44.507</td>
<td>229</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>103.0</td>
<td></td>
<td>NaN</td>
<td>2012-02-13 12:55:43.963</td>
<td></td>
<td></td>
<td>happened aftermath Tet offensive Viet Cong act...</td>
<td></td>
<td>what happen in the aftermath of the Tet offens...</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2011-12-17 04:51:31.127</td>
<td>991</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>338.0</td>
<td>The South was invaded in a regular war by the ...</td>
<td>103.0</td>
<td>2023-01-17 06:19:46.630</td>
<td>Sardathrion - against SE abuse</td>
<td></td>
<td>South Vietnam helped US Even US gone million a...</td>
<td>South invaded regular war North</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>the South be invade in a regular war by the No...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2011-12-17 04:51:31.127</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>NaT</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2012-02-24 05:32:20.690</td>
<td>1466</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>579.0</td>
<td>Did you actually try to find some answer yours...</td>
<td>102.0</td>
<td>2021-08-24 16:28:48.823</td>
<td>o0'.</td>
<td>.:…·•°</td>
<td>WWII France rebuilding mode yet insisted tryin...</td>
<td>actually try find answer asking</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>do you actually try to find some answer yourse...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012-02-24 05:32:20.690</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>NaT</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>In this code block, I have set <code>CreationDate</code> column as the index and replaced duplicate content via the post with empty string while keeping only the first occurence.</p>
<section id="count-the-occurrences-the-common-words" class="level4">
<h4 class="anchored" data-anchor-id="count-the-occurrences-the-common-words">Count the occurrences the common words</h4>
<div id="6b88cf03" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of common words</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>common_words <span class="op">=</span> [<span class="st">"vietnam"</span>, <span class="st">"us"</span>, <span class="st">"war"</span>, <span class="st">"french"</span>, <span class="st">"china"</span>, <span class="st">"france"</span>, <span class="st">"north"</span>, <span class="st">"south"</span>, <span class="st">"american"</span>]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NaN values by empty strings</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Post2'</span>] <span class="op">=</span> df5[<span class="st">'Post2'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>df5[<span class="st">'Comment2'</span>] <span class="op">=</span> df5[<span class="st">'Comment2'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences the common words</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_words(text: <span class="bu">str</span>, words: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.lower()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    word_count <span class="op">=</span> Counter(re.findall(<span class="vs">r"\w+"</span>, text)) <span class="co"># Find all the words and count how many time it appears</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {word: word_count[word] <span class="cf">for</span> word <span class="kw">in</span> words} <span class="co"># Return each word in `common_words` as key, the value is the count how many time it appears</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>count_words(post_string, common_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>{'vietnam': 128,
 'us': 48,
 'war': 91,
 'french': 12,
 'china': 17,
 'france': 14,
 'north': 36,
 'south': 28,
 'american': 19}</code></pre>
</div>
</div>
<p>In this code block, I have created a dictionary of the most common words as the key and the number of occurences as value.</p>
</section>
<section id="count-the-occurrences-the-common-words-yearly" class="level4">
<h4 class="anchored" data-anchor-id="count-the-occurrences-the-common-words-yearly">Count the occurrences the common words yearly</h4>
<div id="ac322b5c" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary to store the common words counted by year</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>yearly_counts <span class="op">=</span> {word: Counter() <span class="cf">for</span> word <span class="kw">in</span> common_words}</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> date, row <span class="kw">in</span> df5.iterrows(): <span class="co"># iterate over the rows of the dataframe as (index (index), Series (row)) pairs</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    year <span class="op">=</span> date.year <span class="co"># extract year from `CreationDate` index</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    post2_counts <span class="op">=</span> count_words(row.Post2, common_words) <span class="co"># dictionary contain word counts for `Post2`</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    comment2_counts <span class="op">=</span> count_words(row.Comment2, common_words) <span class="co"># dictionary contain word counts for `Comment2`</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> common_words:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        yearly_counts[word][year] <span class="op">+=</span> post2_counts[word] <span class="op">+</span> comment2_counts[word] <span class="co"># calculate each word occurrence per year</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `yearly_counts` to dataframe</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>df_counts <span class="op">=</span> pd.DataFrame(yearly_counts).fillna(<span class="dv">0</span>).sort_index()</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>df_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">vietnam</th>
<th data-quarto-table-cell-role="th">us</th>
<th data-quarto-table-cell-role="th">war</th>
<th data-quarto-table-cell-role="th">french</th>
<th data-quarto-table-cell-role="th">china</th>
<th data-quarto-table-cell-role="th">france</th>
<th data-quarto-table-cell-role="th">north</th>
<th data-quarto-table-cell-role="th">south</th>
<th data-quarto-table-cell-role="th">american</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2011</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2012</td>
<td>4</td>
<td>2</td>
<td>12</td>
<td>4</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2013</td>
<td>7</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2014</td>
<td>3</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2015</td>
<td>13</td>
<td>8</td>
<td>17</td>
<td>2</td>
<td>7</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>15</td>
<td>5</td>
<td>9</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>22</td>
<td>6</td>
<td>13</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2018</td>
<td>15</td>
<td>4</td>
<td>8</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>4</td>
<td>4</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>39</td>
<td>17</td>
<td>17</td>
<td>4</td>
<td>7</td>
<td>2</td>
<td>22</td>
<td>11</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021</td>
<td>2</td>
<td>4</td>
<td>3</td>
<td>5</td>
<td>0</td>
<td>8</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022</td>
<td>8</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023</td>
<td>3</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The table output of this code block shows the number of occurences per each word yearly.</p>
</section>
<section id="plot-the-time-series-trend" class="level4">
<h4 class="anchored" data-anchor-id="plot-the-time-series-trend">Plot the time series trend</h4>
<div id="24d10d77" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>line_styles <span class="op">=</span> [<span class="st">'-'</span>, <span class="st">'--'</span>, <span class="st">'-.'</span>, <span class="st">':'</span>, <span class="st">'-'</span>, <span class="st">'--'</span>, <span class="st">'-.'</span>, <span class="st">':'</span>, <span class="st">'-'</span>]  <span class="co"># Different line styles for each word</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>markers <span class="op">=</span> [<span class="st">'o'</span>, <span class="st">'s'</span>, <span class="st">'D'</span>, <span class="st">'^'</span>, <span class="st">'v'</span>, <span class="st">'&lt;'</span>, <span class="st">'&gt;'</span>, <span class="st">'p'</span>, <span class="st">'*'</span>]  <span class="co"># Different markers for each word</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, word <span class="kw">in</span> <span class="bu">enumerate</span>(common_words):</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(df_counts.index, df_counts[word], label<span class="op">=</span>word, linestyle<span class="op">=</span>line_styles[i <span class="op">%</span> <span class="bu">len</span>(line_styles)], marker<span class="op">=</span>markers[i <span class="op">%</span> <span class="bu">len</span>(markers)], markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `df_counts.index` is axis (years), `df_counts[word]` is y-axis(word counts), `label=word` assigns the label for the legend, the rest just ensure each word gets a unique style and marker</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Word Count'</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Trend for Common Words Related to Vietnam History from Post and Comment Columns'</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">'Words'</span>, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/cell-23-output-1.png" width="760" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The words vietnam, us, war seem to be discussed yearly. Other words appear here and there. Interestingly, from 2018 to 2020, people are more interested in the Vietnam War compare to other years. Based on the the popular words. I can deduce that the majority of discussions are on the Vietnam War and the events that triggered the war and what happened after it. To analyze that, I will have to use more advance techniques.</p>
</section>
</section>
</section>
<section id="topic-modelling-for-post" class="level2">
<h2 class="anchored" data-anchor-id="topic-modelling-for-post">Topic modelling for <code>Post</code></h2>
<p>I will be applying Bertopic to categorize the post labels. More information on: <code>https://colab.research.google.com/drive/1BoQ_vakEVtojsd2x_U6-_x52OOuqruj2?usp=sharing#scrollTo=sVfnYtUaxyLT</code></p>
<section id="openai-summarize-post3" class="level3">
<h3 class="anchored" data-anchor-id="openai-summarize-post3">OpenAI summarize <code>Post3</code></h3>
<p>I will use <code>openai</code> api and the model <code>gpt3.5</code> to summarize the <code>Post3</code>.</p>
<div id="47044922" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># client = openai.OpenAI(api_key="...")</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function to tell gpt to summarize the text</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># def post_summary(text):</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     response = client.chat.completions.create(</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         model="gpt-3.5-turbo",</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">#         messages=[</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         {"role": "system", "content": "You are a expert in Vietnamese History. Summarize and shorten this given question."},</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         {"role": "user", "content": f"{text}"},</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">#       ]</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     return response.choices[0].message.content</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># test = df4.head(1)</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # test['Post_summary'] = test['Post3'].dropna().apply(post_summary)</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # test['Post_summary'][0]</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># df4['Post_summary'] = df4['Post3'].dropna().apply(post_summary)</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # Saving the post</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co"># df5 = df4.copy()</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co"># df5.to_csv('df5.csv', index=False)</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>df5 <span class="op">=</span> pd.read_csv(<span class="st">'df5.csv'</span>)</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>df5.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post</th>
<th data-quarto-table-cell-role="th">PostUserId</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">UserCommentId</th>
<th data-quarto-table-cell-role="th">CreationDate</th>
<th data-quarto-table-cell-role="th">LastActivityDate</th>
<th data-quarto-table-cell-role="th">UserCommentName</th>
<th data-quarto-table-cell-role="th">UserCommentLocation</th>
<th data-quarto-table-cell-role="th">Post2</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">Comment3</th>
<th data-quarto-table-cell-role="th">Post_summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>229</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>103.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2011-10-13 08:12:44.507</td>
<td>2012-02-13 12:55:43.963</td>
<td>NaN</td>
<td>NaN</td>
<td>happened aftermath Tet offensive Viet Cong act...</td>
<td>NaN</td>
<td>what happen in the aftermath of the Tet offens...</td>
<td>NaN</td>
<td>What happened to the Viet Cong after the Tet O...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>991</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>338.0</td>
<td>The South was invaded in a regular war by the ...</td>
<td>103.0</td>
<td>2011-12-17 04:51:31.127</td>
<td>2023-01-17 06:19:46.630</td>
<td>Sardathrion - against SE abuse</td>
<td>NaN</td>
<td>South Vietnam helped US Even US gone million a...</td>
<td>South invaded regular war North</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>the South be invade in a regular war by the No...</td>
<td>Despite having strong support from the US and ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>991</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>338.0</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>13404.0</td>
<td>2011-12-17 04:51:31.127</td>
<td>2023-01-17 06:19:46.630</td>
<td>user3847</td>
<td>NaN</td>
<td>South Vietnam helped US Even US gone million a...</td>
<td>Ill forego lengthy analysis simply recommend b...</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>I will forego a lengthy analysis and simply re...</td>
<td>Despite receiving substantial support from the...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1466</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>579.0</td>
<td>Did you actually try to find some answer yours...</td>
<td>102.0</td>
<td>2012-02-24 05:32:20.690</td>
<td>2021-08-24 16:28:48.823</td>
<td>o0'.</td>
<td>.:…·•°</td>
<td>WWII France rebuilding mode yet insisted tryin...</td>
<td>actually try find answer asking</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>do you actually try to find some answer yourse...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1466</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>579.0</td>
<td>I did some searching, but as far as I could fi...</td>
<td>579.0</td>
<td>2012-02-24 05:32:20.690</td>
<td>2021-08-24 16:28:48.823</td>
<td>ihtkwot</td>
<td>Chicago, IL, United States</td>
<td>WWII France rebuilding mode yet insisted tryin...</td>
<td>searching far could find French interested rec...</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>I do some searching , but as far as I could fi...</td>
<td>Why did the post-World War II French governmen...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>I have run the code in a separate jupyter notebook and save the output to a <code>csv</code> file.</p>
</section>
<section id="row-splitter" class="level3">
<h3 class="anchored" data-anchor-id="row-splitter">Row splitter</h3>
<p>I will be splitting each row of the <code>Post_summary</code> column for training</p>
<div id="c945524e" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop `Post3` duplicates</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df6 <span class="op">=</span> df5.drop_duplicates(<span class="st">'Post3'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df6 <span class="op">=</span> df5.copy()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split row summary summarized by openai</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>row_splitter <span class="op">=</span> df6[<span class="st">'Post_summary'</span>].tolist()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>row_splitter[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>['What happened to the Viet Cong after the Tet Offensive? Did they break away or become part of the North Vietnamese army? How significant was their role in the overall victory in the Vietnam War, focusing on the counterinsurgency aspect?',
 'Despite having strong support from the US and comparable military capabilities, South Vietnam ultimately lost the Vietnam War. The question arises as to why this defeat occurred despite these advantages.',
 'Despite receiving substantial support from the US, the South Vietnamese army ultimately lost the war. Despite having a comparable amount of manpower, technology, and industrialization compared to North Vietnam after the US withdrawal, South Vietnam still could not win. Why did they lose?',
 'Why did post-WWII France prioritize reclaiming Indo-China despite being in rebuild mode?',
 'Why did the post-World War II French government pursue reclaiming Indo-China despite being in a rebuild mode?']</code></pre>
</div>
</div>
</section>
<section id="pre-calculate-embeddings" class="level3">
<h3 class="anchored" data-anchor-id="pre-calculate-embeddings">Pre-calculate Embeddings</h3>
<p>We convert the <code>row_splitter</code> into numerical values called embeddings. Then feed that to Bertopic to skip calculating the embeddings each time.</p>
<div id="45c87476" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-calculate embeddings</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>embedding_model <span class="op">=</span> SentenceTransformer(<span class="st">"all-MiniLM-L6-v2"</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># embeddings = embedding_model.encode(row_splitter, show_progress_bar=True)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="apply-bert" class="level3">
<h3 class="anchored" data-anchor-id="apply-bert">Apply Bert</h3>
<div id="1df20d5c" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # KeyBERT</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># keybert_model = KeyBERTInspired()</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Part-of-Speech</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pos_model = PartOfSpeech("en_core_web_sm")</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # MMR</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mmr_model = MaximalMarginalRelevance(diversity=0.3)</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # GPT-3.5</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># prompt = """</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I have a topic that contains the following documents:</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># [DOCUMENTS]</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The topic is described by the following keywords: [KEYWORDS]</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Based on the information above, extract a short but highly descriptive topic label of at most 5 words. Make sure it is in the following format:</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># topic: &lt;topic label&gt;</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co"># """</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co"># client = openai.OpenAI(api_key="sk-proj-QFpbTwzLPdgj5h9SbTsLT3BlbkFJrvE2Kz8SXXOuV8VsmqvU")</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># openai_model = OpenAI(client, model="gpt-3.5-turbo", exponential_backoff=True, chat=True, prompt=prompt)</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fine-tune the topic representations</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="co"># representation_model = {</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     "KeyBERT": keybert_model,</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     "OpenAI": openai_model,  # Uncomment if you will use OpenAI</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     "MMR": mmr_model,</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     "POS": pos_model</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="co"># # set the model and parameters</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="co"># topic_model = BERTopic(embedding_model=embedding_model,</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     min_topic_size=5,  # min topic</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     nr_topics=20, # max topic</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     representation_model=representation_model,</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     calculate_probabilities=True</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="co"># topics, probs = topic_model.fit_transform(row_splitter)</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="co"># # Saving the model</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="co"># topic_model.save("postmodel", serialization="pytorch", save_ctfidf=True, save_embedding_model=embedding_model)</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Input the saved model</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>post_model <span class="op">=</span> BERTopic.load(<span class="st">"postmodel"</span>, embedding_model<span class="op">=</span>embedding_model)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>post_model_info <span class="op">=</span> post_model.get_topic_info()</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>post_model_info</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Topic</th>
<th data-quarto-table-cell-role="th">Count</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Representation</th>
<th data-quarto-table-cell-role="th">KeyBERT</th>
<th data-quarto-table-cell-role="th">OpenAI</th>
<th data-quarto-table-cell-role="th">MMR</th>
<th data-quarto-table-cell-role="th">POS</th>
<th data-quarto-table-cell-role="th">Representative_Docs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1</td>
<td>16</td>
<td>-1_language_toilet_translators_used</td>
<td>[language, toilet, translators, used, weapon, ...</td>
<td>[vietnamese, vietnam, popeye, drought, minh, t...</td>
<td>[Military Translators in Vietnam]</td>
<td>[language, toilet, translators, used, weapon, ...</td>
<td>[language, toilet, translators, weapon, operat...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>89</td>
<td>0_north_china_war_support</td>
<td>[north, china, war, support, vietnam, soviet, ...</td>
<td>[vietnam, vietnamese, indochina, troops, viet,...</td>
<td>[Chinese military support in wars]</td>
<td>[north, china, war, support, vietnam, soviet, ...</td>
<td>[north, war, support, military, states, forces...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>19</td>
<td>1_served_casualty_wounded_combat</td>
<td>[served, casualty, wounded, combat, high, rate...</td>
<td>[casualties, wounded, veterans, vietnam, casua...</td>
<td>[Vietnam War casualty statistics]</td>
<td>[served, casualty, wounded, combat, high, rate...</td>
<td>[casualty, combat, high, rate, soldiers, days,...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2</td>
<td>18</td>
<td>2_red_symbol_location_photo</td>
<td>[red, symbol, location, photo, infantry, divis...</td>
<td>[vietnam, soldiers, marching, regiment, symbol...</td>
<td>[Vietnam War protest symbol photos]</td>
<td>[red, symbol, location, photo, infantry, divis...</td>
<td>[red, symbol, location, photo, protest, soldie...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3</td>
<td>17</td>
<td>3_racism_theater_pacific_ad</td>
<td>[racism, theater, pacific, ad, manipulated, pa...</td>
<td>[vietnam, racism, vietnamese, ethnic, war, ngu...</td>
<td>[Racism in Pacific war theater]</td>
<td>[racism, theater, pacific, ad, manipulated, pa...</td>
<td>[racism, theater, ethnic, perspective, era, ch...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>4</td>
<td>17</td>
<td>4_france_indo_did_rebuilding</td>
<td>[france, indo, did, rebuilding, french, post, ...</td>
<td>[indochina, france, reclaiming, china, reclaim...</td>
<td>[France's Post-WWII Indo-China Reclamation]</td>
<td>[france, indo, did, rebuilding, french, post, ...</td>
<td>[rebuilding, post, colonies, significant, phas...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>5</td>
<td>14</td>
<td>5_invasion_cambodia_khmer_rouge</td>
<td>[invasion, cambodia, khmer, rouge, cambodian, ...</td>
<td>[cambodians, vietnam, cambodia, cambodian, vie...</td>
<td>[Global Opposition to Vietnamese Invasion]</td>
<td>[invasion, cambodia, khmer, rouge, cambodian, ...</td>
<td>[invasion, genocide, opposition, power, lack, ...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>6</td>
<td>13</td>
<td>6_nations_nigeria_germany_iraq</td>
<td>[nations, nigeria, germany, iraq, suffer, liby...</td>
<td>[nations, wwii, countries, war, wars, iraq, ec...</td>
<td>[Post-War Recovery Disparities]</td>
<td>[nations, nigeria, germany, iraq, suffer, liby...</td>
<td>[nations, wars, major, able, conflicts, afterm...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>7</td>
<td>12</td>
<td>7_president_industrial_complex_johnson</td>
<td>[president, industrial, complex, johnson, deci...</td>
<td>[lyndon, vietnam, jfk, johnson, lbj, kennedy, ...</td>
<td>[Vietnam War Decision Influences]</td>
<td>[president, industrial, complex, johnson, deci...</td>
<td>[industrial, complex, decision, miscalculation...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>8</td>
<td>12</td>
<td>8_camps_pow_activity_presentation</td>
<td>[camps, pow, activity, presentation, condition...</td>
<td>[camps, prisoners, presentation, torture, hano...</td>
<td>[Comparing WWII POW Camps]</td>
<td>[camps, pow, activity, presentation, condition...</td>
<td>[camps, activity, presentation, conditions, di...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>9</td>
<td>10</td>
<td>9_nixon_talks_treason_richard</td>
<td>[nixon, talks, treason, richard, 1968, paris, ...</td>
<td>[nixon, vietnam, treason, vietnamese, lyndon, ...</td>
<td>[Nixon's Manipulation in 1968]</td>
<td>[nixon, talks, treason, richard, 1968, paris, ...</td>
<td>[talks, treason, peace, president, manipulatio...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>10</td>
<td>10</td>
<td>10_tons_000_bombs_dropped</td>
<td>[tons, 000, bombs, dropped, 500, napalm, milli...</td>
<td>[bombs, bombing, vietnam, bomb, tons, wwii, so...</td>
<td>[Bombing Campaign Comparison]</td>
<td>[tons, 000, bombs, dropped, 500, napalm, milli...</td>
<td>[tons, bombs, napalm, pilots, bombing, trail, ...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>11</td>
<td>9</td>
<td>11_blue_term_tag_discharge</td>
<td>[blue, term, tag, discharge, program, slang, p...</td>
<td>[vietnam, blue, soldier, military, discharge, ...</td>
<td>[Unrecognized Term "Blue Tag" Interpretation]</td>
<td>[blue, term, tag, discharge, program, slang, p...</td>
<td>[blue, term, discharge, tag, program, slang, p...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>12</td>
<td>7</td>
<td>12_draft_ted_nugent_avoid</td>
<td>[draft, ted, nugent, avoid, pants, page, wikip...</td>
<td>[vietnam, ted, draft, nugent, defecated, alleg...</td>
<td>[Ted Nugent's Vietnam Draft Dodging]</td>
<td>[draft, ted, nugent, avoid, pants, page, wikip...</td>
<td>[draft, pants, page, dodger, deferments, servi...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>13</td>
<td>7</td>
<td>13_party_members_communist_sympathetic</td>
<td>[party, members, communist, sympathetic, draft...</td>
<td>[vietnam, draftees, draft, vietnamese, drafted...</td>
<td>[Treatment of Communist Draftees]</td>
<td>[party, members, communist, sympathetic, draft...</td>
<td>[members, sympathetic, draftees, military, exe...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>14</td>
<td>6</td>
<td>14_politician_russia_embarrassment_ukraine</td>
<td>[politician, russia, embarrassment, ukraine, r...</td>
<td>[vietnam, chechnya, russian, russia, embarrass...</td>
<td>[Russian Politician's Vietnam References]</td>
<td>[politician, russia, embarrassment, ukraine, r...</td>
<td>[politician, embarrassment, shame, hump, decla...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>15</td>
<td>6</td>
<td>15_city_purple_forbidden_imperial</td>
<td>[city, purple, forbidden, imperial, huế, domai...</td>
<td>[vietnam, huế, purple, beijing, emperor, forbi...</td>
<td>[Imperial Purple Forbidden City]</td>
<td>[city, purple, forbidden, imperial, huế, domai...</td>
<td>[purple, imperial, personal, domain, servants,...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>16</td>
<td>6</td>
<td>16_tours_57_uso_bob</td>
<td>[tours, 57, uso, bob, hope, record, documentat...</td>
<td>[tours, tour, 57, record, uso, hope, seeks, or...</td>
<td>[Bob Hope's USO Tours Record]</td>
<td>[tours, 57, uso, bob, hope, record, documentat...</td>
<td>[tours, record, documentation, sources, questi...</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>17</td>
<td>6</td>
<td>17_catholic_diem_buddhist_majority</td>
<td>[catholic, diem, buddhist, majority, dinh, bud...</td>
<td>[buddhists, ngo, buddhist, vietnamese, vietnam...</td>
<td>[Catholic oppression in Vietnam]</td>
<td>[catholic, diem, buddhist, majority, dinh, bud...</td>
<td>[majority, persecution, regime, minority, popu...</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>18</td>
<td>6</td>
<td>18_faction_saigon_trình_thế</td>
<td>[faction, saigon, trình, thế, minh, jammes, 19...</td>
<td>[saigon, vietnam, communists, trình, trinh, gr...</td>
<td>[US Involvement in Saigon Bombings]</td>
<td>[faction, saigon, trình, thế, minh, jammes, 19...</td>
<td>[faction, caodaiist, novel, actions, parade, c...</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>I have already saved the Bertopic model and will just import it each time I run this cell.</p>
</section>
<section id="save-the-topics-and-corresponding-posts" class="level3">
<h3 class="anchored" data-anchor-id="save-the-topics-and-corresponding-posts">Save the topics and corresponding posts</h3>
<p>So I already haved saved the topics and corresponding posts. Now I will just import them</p>
<div id="9f2215a8" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df7 = pd.DataFrame({'topic': topics, 'Original Post': df6.Post, 'OpenAI Post Summary': df6.Post_summary})</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df7.drop_duplicates('Original Post', inplace=True)</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Merge OpenAI label on topic column</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df7 = df7.merge(topic_model_info[['Topic', 'OpenAI', 'KeyBERT']], left_on='topic', right_on='Topic', how='left')</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Rename and rearrange columns</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># df7.drop('Topic', axis=1, inplace=True)</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># df7.rename({'OpenAI':'OpenAI Post Label','KeyBERT':'KeyBERT Post Label', 'topic':'Post Topic'}, inplace=True, axis=1)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # Export the dataframe</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># df7.to_csv('df7.csv', index=False)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Import df7</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>df7 <span class="op">=</span> pd.read_csv(<span class="st">'df7.csv'</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>df7.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>17</td>
<td>In 1963, weeks before his own assassination, P...</td>
<td>In 1963, President Kennedy approved CIA plans ...</td>
<td>['Catholic oppression in Vietnam']</td>
<td>['buddhists', 'ngo', 'buddhist', 'vietnamese',...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>The Khmer Rouge killed about 25% of the Cambod...</td>
<td>Were there studies conducted on the potential ...</td>
<td>['Global Opposition to Vietnamese Invasion']</td>
<td>['cambodians', 'vietnam', 'cambodia', 'cambodi...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>This dataframe gives me enough information to analyze for the next section.</p>
</section>
</section>
<section id="vietnam-map-to-show-different-historical-events-and-places-in-the-post" class="level2">
<h2 class="anchored" data-anchor-id="vietnam-map-to-show-different-historical-events-and-places-in-the-post">Vietnam map to show different historical events and places in the <code>Post</code></h2>
<p>Since there are not many posts related to Vietnam History. I will have a read through them and look out for different events and locations. I will do that by examining the posts for each <code>Post Topic</code>. Here is a sample on how I analyze it.</p>
<div id="2fba5ee7" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df7.loc[df7[<span class="st">'Post Topic'</span>] <span class="op">==</span> <span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>The Khmer Rouge killed about 25% of the Cambod...</td>
<td>Were there studies conducted on the potential ...</td>
<td>['Global Opposition to Vietnamese Invasion']</td>
<td>['cambodians', 'vietnam', 'cambodia', 'cambodi...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>5</td>
<td>This was a major raid by Khmer Rouge forces ov...</td>
<td>Khmer Rouge forces carried out a major raid ov...</td>
<td>['Global Opposition to Vietnamese Invasion']</td>
<td>['cambodians', 'vietnam', 'cambodia', 'cambodi...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>5</td>
<td>Despite the genocide happening in Cambodia, th...</td>
<td>The question explores the rationale behind the...</td>
<td>['Global Opposition to Vietnamese Invasion']</td>
<td>['cambodians', 'vietnam', 'cambodia', 'cambodi...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Here is a list of events and locations that happen in Vietnam or close to Vietnam from after reading through each post: Tet Offensive; Fall of Saigon; Operation Popeye; Battle of Dien Bien Phu; Ngo Dinh Diem’s assassination; Ba Chúc massacre; My Lai massacre; Operation Wandering Soul; My Son Sanctuary; a bridge destroyed by Big Red One; 1st Infantry Division; Tu Do street or Dong Khoi street; Imperial City of Huel; Ho Chi Minh trail (eastern border with Laos and Cambodia), Vietnam War (Gulf of Tonkin Incident).</p>
<p>I will plot this on the Vietnam map.</p>
<div id="3e6f225d" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coords for Ho Chi Minh Trail</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ho_chi_minh_trail <span class="op">=</span> [</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">21.0285</span>, <span class="fl">105.8542</span>],  <span class="co"># Hanoi</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">20.4855</span>, <span class="fl">104.2375</span>],  <span class="co"># Near Lao Bao, Vietnam</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">19.3092</span>, <span class="fl">103.9235</span>],  <span class="co"># Along the trail in Laos</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">18.2048</span>, <span class="fl">103.4167</span>],  <span class="co"># Along the trail in Laos</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">17.9725</span>, <span class="fl">106.2800</span>],  <span class="co"># Near Dong Hoi, Vietnam</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">17.2135</span>, <span class="fl">106.1106</span>],  <span class="co"># Near Khe Sanh, Vietnam</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">16.2610</span>, <span class="fl">107.5807</span>],  <span class="co"># Near A Luoi, Vietnam</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">15.0500</span>, <span class="fl">108.5000</span>],  <span class="co"># Near Dak To, Vietnam</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">13.7563</span>, <span class="fl">109.1996</span>],  <span class="co"># Near Pleiku, Vietnam</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">12.2388</span>, <span class="fl">107.7340</span>],  <span class="co"># Near Buon Ma Thuot, Vietnam</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">11.5449</span>, <span class="fl">104.8922</span>],  <span class="co"># Phnom Penh, Cambodia</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">10.5763</span>, <span class="fl">105.2094</span>],  <span class="co"># Along the trail in Cambodia</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">10.8231</span>, <span class="fl">106.6297</span>]   <span class="co"># Ho Chi Minh City (Saigon)</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Locations and descriptions</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>locations <span class="op">=</span> [</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">16.47860161558329</span>, <span class="fl">107.57420678169986</span>), <span class="co"># Hue Historic Citadel coords</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Battle of Hue"</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"On January 31, 1968, The bloodiest battle of the Tet offensive took place at Hue. The PAVN and Viet cong attacked the city on the 31 January of 1968 and took over the city’s ancient citadel. The North Vietnam occupation of the city was not long as the American regained control on the February 26, but the damage was done. The statistics show that around 2800 bodies and 3000 residents were missing from the South Vietnam, while from North Vietnam 5000 soldiers died from. The battle of Hue and the Tet Offensive in general had halted the peace talk and it is a turning point for the war.</span><span class="ch">\n</span><span class="st">Source: https://www.history.com/topics/vietnam-war/tet-offensive"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://huedaytour.com/wp-content/uploads/hue-imperial-citadel-2.jpg"</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">10.7772366108138</span>, <span class="fl">106.69536647283701</span>), <span class="co"># Presidential Palace in Sai Gon coords</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Ngo Dinh Diem assassination"</span>,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Ngo Dinh Diem was the South Vietnam president in 1955 after a controlled referendum against the Bao Dai, the last emperor of Vietnam. With the support of the US, Diem had resettled hundreds of thousands of refugees escaped from North Vietnam. Despite the alliance with the US and Diem’s personal hatred to communism, his presidency shown many characteristics of a dictatorship. From consolidating power within his family, discriminating Buddhists over Catholics in a Buddhist country to failing to implement land reforms and suppression of political opposition. All of these factors led to the US ordering Diem’s generals to assassinate him in a coup d’état on 2nd November 1963.</span><span class="ch">\n</span><span class="st">Source: https://www.britannica.com/biography/Ngo-Dinh-Diem"</span>,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://lh5.googleusercontent.com/p/AF1QipMSw2-evUD0n0ibQLXkkthzFwOhDct59iVvQLA=w408-h306-k-no"</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">10.816673671427983</span>, <span class="fl">106.64435715018435</span>),</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"The fall of SaiGon in 1975"</span>, </span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"The Fall of Sai Gon marked the end of a 2-decade war between Vietnam and America. In the final stages of the war, the North Vietnam army, and the Viet Cong capture city after city. This was due to President Nixon policy of Vietnamization where the American would train and equip the South Vietnamese military to take over the conduct of the war, and gradually reduce the American army and support. With the already unstable South Vietnam, couple with the American were leaving, left the South Vietnam to be vulnerable to the attacks of North Vietnam and eventually led to their demise.</span><span class="ch">\n</span><span class="st">Souce: https://www.history.com/topics/vietnam-war/vietnamization"</span>,</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://api.time.com/wp-content/uploads/2015/04/saigon.jpeg?quality=85&amp;w=1080"</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">19.986955480290767</span>, <span class="fl">107.75467673613805</span>),</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Gulf of Tonkin Incident in 1964"</span>, </span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Two American destroyers USS Maddox and USS Turner Jou were conducting intelligence-gathering operations in the Gulf of Tonkin. On the 2nd of August, the Maddox was being approached by 3 North Vietnamese torpedo boats. The Maddox fired a warning shot, but the torpedo boats opened fried. This led to the intervention of American air support and the US to believe the North Vietnam was targeting their intelligence gathering mission. 2 days after that, on a stormy night both the destroyers were operating in the gulf of Tonkin when they reported detecting multiple unidentified vessels approaching them. They open fired when called in air support. But in actuality, there were no enemy boats to be found. These two incidents had led to the Congress passing the Gulf of Tonkin Resolution granting President Johnson the escalate the US military presence in Vietnam.</span><span class="ch">\n</span><span class="st">Sorce: https://www.britannica.com/event/Gulf-of-Tonkin-incident"</span>,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://lh5.googleusercontent.com/p/AF1QipPxQMj1GuhSE0UDJ8hEjVlYgjotAqcuWa-toa_F=w408-h306-k-no"</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">19.3092</span>, <span class="fl">103.9235</span>),</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Operation Popeye"</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Operation Popeye or Project Popeye was a weather modification program used by the US in the Vietnam War. The American sent around 2600 cloud seeding (a technique to improve the clouds’ ability to produce rain) on a part of the Ho Chi Minh Trail, near the border of Vietnam, Laos, Cambodia. The objective of the operation was to extend the monsoon season fir 30 to 45 days in order to disrupt the supply line of the Vietnamese.</span><span class="ch">\n</span><span class="st">Source. https://polarpedia.eu/en/operation-popeye/"</span>,</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://99percentinvisible.org/app/uploads/2018/03/trail-usage.jpg"</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">18.2048</span>, <span class="fl">103.4167</span>),</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Operation Popeye"</span>,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Operation Popeye or Project Popeye was a weather modification program used by the US in the Vietnam War. The American sent around 2600 cloud seeding (a technique to improve the clouds’ ability to produce rain) on a part of the Ho Chi Minh Trail, near the border of Vietnam, Laos, Cambodia. The objective of the operation was to extend the monsoon season fir 30 to 45 days in order to disrupt the supply line of the Vietnamese.</span><span class="ch">\n</span><span class="st">Source. https://polarpedia.eu/en/operation-popeye/"</span>,</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://99percentinvisible.org/app/uploads/2018/03/trail-usage.jpg"</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">10.5763</span>, <span class="fl">105.2094</span>),</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Operation Popeye"</span>,</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Operation Popeye or Project Popeye was a weather modification program used by the US in the Vietnam War. The American sent around 2600 cloud seeding (a technique to improve the clouds’ ability to produce rain) on a part of the Ho Chi Minh Trail, near the border of Vietnam, Laos, Cambodia. The objective of the operation was to extend the monsoon season fir 30 to 45 days in order to disrupt the supply line of the Vietnamese.</span><span class="ch">\n</span><span class="st">Source. https://polarpedia.eu/en/operation-popeye/"</span>,</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://99percentinvisible.org/app/uploads/2018/03/trail-usage.jpg"</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">21.57235955732699</span>, <span class="fl">103.09442549952763</span>),</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Battle of Dien Bien Phu"</span>,</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Dien Bien Phu Valley was a military stronghold of the French during the First Indochina War between France and Vietnam. The reasons for France occupation of Dien Bien Phu were to destroy the supply lines of Vietnam from Laos and force the Viet Minh to an open attack. Under the leadership of general Vo Nguyen Giap, the Viet Minh army surround the valley. They dug out many artillery positions on steep slopes. On March 13, 1954, Viet Minh started their attacks. For the next two months, the Vietnamese attacked the French using artillery fire and trench warfare to isolate the French garrisons. This caused the French to lose their outposts, airstrips, and many damaged aircrafts. The final victory belongs to the Vietnamese, but the human toll on both sides was tremendous, with the French losing 2200 soldiers in actions and another 3300 prisoners died on captivity. After the battle, the France and Vietnam had a conference named Geneva in July of 1954 for peace talks. The terms of the peace agreement called for temporary partition of North and South Vietnam. The North was the Communist side with the supported of USSR and China while the South had the supported of the US and some of the allies. These events ultimately led to the Vietnam War or Second Indochina War.</span><span class="ch">\n</span><span class="st">Source: https://www.history.com/topics/european-history/battle-of-dien-bien-phu"</span>,</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://assets.editorial.aetnd.com/uploads/2009/10/battle-of-dien-bien-phu-gettyimages-548191747.jpg?width=1920&amp;height=960&amp;crop=1920%3A960%2Csmart&amp;quality=75&amp;auto=webp"</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">10.59194693146919</span>, <span class="fl">104.92222286168393</span>),</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"Ba Chuc massacre"</span>,</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"Khmer Rouge, a terror regime led by Pol Pot which killed millions of Cambodians which sought Vietnam was their next target. After their defeats in 1977 where the Khmer Rouge killed 1000 Vietnamese, and Vietnam retaliated by launching several successful campaigns, the Khmer Rouge came back in 1978. In April of that year, they crossed the border and attacked Ba Chuc village. Only 12 days, they mass murdered 3000 Vietnamese and there were only 2 known survivors. These caused Vietnam to attack full force and capture Phnom Penh (the capital of Cambodia) in January of 1979, ending the Pol Pot regime. China, who supported the Khmer Rouge financial, feared the expansion of Vietnam, started a Sino-Vietnamese War which lasted for 27 days.</span><span class="ch">\n</span><span class="st">Source: https://solotravellerontour.com/mekong-delta-border-loop-ba-chuc-tomb/"</span>,</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://todayinhistory.blog/wp-content/uploads/2019/01/killingfields-ft-1.m.jpg?w=840"</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">15.266432532765865</span>, <span class="fl">108.87073271815387</span>),</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"My Lai massacre"</span>,</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"After the Tet Offensive, the American soldiers’ morale was dwindling, and they heard words that the Viet Cong was hiding inside village My Lai in Son My. The Americans then sent soldiers to the village to investigate but found only children, women, old men, and little to no weapons. Nonetheless, the William Calley, the commander of the raid, ordered his men to shoot the villagers. On that day, March 16, 1968, more than 500 people were slaughtered with many young girls and women were raped and then killed. The brutality of My Lai massacre was covered by a year until it was exposed, and this fuelled anti-war sentiment and further divided the US over the Vietnam War.</span><span class="ch">\n</span><span class="st">Source: https://www.history.com/topics/vietnam-war/my-lai-massacre-1"</span>,</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://lh5.googleusercontent.com/p/AF1QipPg0wtVE4e8-fF4djBNHoO02LjbYLJGWPwwR316=w408-h306-k-no"</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">"coords"</span>: (<span class="fl">15.792439795074536</span>, <span class="fl">108.11623074979195</span>),</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"title"</span>: <span class="st">"My Son Sanctuary"</span>,</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>        <span class="st">"content"</span>: <span class="st">"My Son Sanctuary is a remnant of the religious and political capital of the Champa Kingdom that ruled over central Vietnam between the 4th and 13th centuries. The people of Cham originated from India and the remnant shows impressive tower temples influenced by Hinduism.</span><span class="ch">\n</span><span class="st">Source: https://whc.unesco.org/en/list/949/"</span>,</span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>        <span class="st">"image_url"</span>: <span class="st">"https://lh5.googleusercontent.com/p/AF1QipOJB4gopDoyd5npVWRpj150XMZT_v52EHpja9NQ=w408-h305-k-no"</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the map at Da Nang, the central of Vietnam</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>vietnam_map <span class="op">=</span> folium.Map(location<span class="op">=</span>[<span class="fl">15.846337671503933</span>, <span class="fl">108.11359994009183</span>], zoom_start<span class="op">=</span><span class="fl">5.4</span>)</span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Add markers to the Vietnam map</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> location <span class="kw">in</span> locations:</span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a>    iframe <span class="op">=</span> folium.IFrame(</span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"&lt;strong&gt;</span><span class="sc">{</span>location[<span class="st">'title'</span>]<span class="sc">}</span><span class="ss">&lt;/strong&gt;&lt;br&gt;</span><span class="sc">{</span>location[<span class="st">'content'</span>]<span class="sc">}</span><span class="ss">&lt;br&gt;&lt;img src='</span><span class="sc">{</span>location[<span class="st">'image_url'</span>]<span class="sc">}</span><span class="ss">' alt='hist_img' width='270px'&gt;"</span>,</span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a>        height<span class="op">=</span><span class="dv">300</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a>    popup <span class="op">=</span> folium.Popup(iframe, max_width<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>    folium.Marker(</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a>        location<span class="op">=</span>location[<span class="st">'coords'</span>],</span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a>        popup<span class="op">=</span>popup,</span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">=</span>location[<span class="st">'title'</span>]</span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a>    ).add_to(vietnam_map)</span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the Ho Chi Minh trail on the map</span></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>folium.PolyLine(ho_chi_minh_trail, color<span class="op">=</span><span class="st">"red"</span>, weight<span class="op">=</span><span class="fl">2.5</span>, opacity<span class="op">=</span><span class="dv">1</span>).add_to(vietnam_map)</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the map in the Jupyter Notebook</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>vietnam_map</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -&gt; Trust Notebook</span><iframe srcdoc="<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; />
    
        <script>
            L_NO_TOUCH = false;
            L_DISABLE_3D = false;
        </script>
    
    <style>html, body {width: 100%;height: 100%;margin: 0;padding: 0;}</style>
    <style>#map {position:absolute;top:0;bottom:0;right:0;left:0;}</style>
    <script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;></script>
    <script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;></script>
    <script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;></script>
    <script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;></script>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/>
    <link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/>
    
            <meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; />
            <style>
                #map_65457a04584bdce7d07acf3939caeee8 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>
        
</head>
<body>
    
    
            <div class=&quot;folium-map&quot; id=&quot;map_65457a04584bdce7d07acf3939caeee8&quot; ></div>
        
</body>
<script>
    
    
            var map_65457a04584bdce7d07acf3939caeee8 = L.map(
                &quot;map_65457a04584bdce7d07acf3939caeee8&quot;,
                {
                    center: [15.846337671503933, 108.11359994009183],
                    crs: L.CRS.EPSG3857,
                    zoom: 5.4,
                    zoomControl: true,
                    preferCanvas: false,
                }
            );

            

        
    
            var tile_layer_7d1a397be007bee7f1413af37bb91372 = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {&quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;, &quot;detectRetina&quot;: false, &quot;maxNativeZoom&quot;: 19, &quot;maxZoom&quot;: 19, &quot;minZoom&quot;: 0, &quot;noWrap&quot;: false, &quot;opacity&quot;: 1, &quot;subdomains&quot;: &quot;abc&quot;, &quot;tms&quot;: false}
            );
        
    
            tile_layer_7d1a397be007bee7f1413af37bb91372.addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
            var marker_394e7ee79b2984c9b4f6f02df01346b9 = L.marker(
                [16.47860161558329, 107.57420678169986],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_a2b6626ffa81ec5da7b95508fe987276 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_0d7b69ace51a95940af30e7199d29ac1 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPkJhdHRsZSBvZiBIdWU8L3N0cm9uZz48YnI+T24gSmFudWFyeSAzMSwgMTk2OCwgVGhlIGJsb29kaWVzdCBiYXR0bGUgb2YgdGhlIFRldCBvZmZlbnNpdmUgdG9vayBwbGFjZSBhdCBIdWUuIFRoZSBQQVZOIGFuZCBWaWV0IGNvbmcgYXR0YWNrZWQgdGhlIGNpdHkgb24gdGhlIDMxIEphbnVhcnkgb2YgMTk2OCBhbmQgdG9vayBvdmVyIHRoZSBjaXR54oCZcyBhbmNpZW50IGNpdGFkZWwuIFRoZSBOb3J0aCBWaWV0bmFtIG9jY3VwYXRpb24gb2YgdGhlIGNpdHkgd2FzIG5vdCBsb25nIGFzIHRoZSBBbWVyaWNhbiByZWdhaW5lZCBjb250cm9sIG9uIHRoZSBGZWJydWFyeSAyNiwgYnV0IHRoZSBkYW1hZ2Ugd2FzIGRvbmUuIFRoZSBzdGF0aXN0aWNzIHNob3cgdGhhdCBhcm91bmQgMjgwMCBib2RpZXMgYW5kIDMwMDAgcmVzaWRlbnRzIHdlcmUgbWlzc2luZyBmcm9tIHRoZSBTb3V0aCBWaWV0bmFtLCB3aGlsZSBmcm9tIE5vcnRoIFZpZXRuYW0gNTAwMCBzb2xkaWVycyBkaWVkIGZyb20uIFRoZSBiYXR0bGUgb2YgSHVlIGFuZCB0aGUgVGV0IE9mZmVuc2l2ZSBpbiBnZW5lcmFsIGhhZCBoYWx0ZWQgdGhlIHBlYWNlIHRhbGsgYW5kIGl0IGlzIGEgdHVybmluZyBwb2ludCBmb3IgdGhlIHdhci4KU291cmNlOiBodHRwczovL3d3dy5oaXN0b3J5LmNvbS90b3BpY3MvdmlldG5hbS13YXIvdGV0LW9mZmVuc2l2ZTxicj48aW1nIHNyYz0naHR0cHM6Ly9odWVkYXl0b3VyLmNvbS93cC1jb250ZW50L3VwbG9hZHMvaHVlLWltcGVyaWFsLWNpdGFkZWwtMi5qcGcnIGFsdD0naGlzdF9pbWcnIHdpZHRoPScyNzBweCc+&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_a2b6626ffa81ec5da7b95508fe987276.setContent(i_frame_0d7b69ace51a95940af30e7199d29ac1);
            
        

        marker_394e7ee79b2984c9b4f6f02df01346b9.bindPopup(popup_a2b6626ffa81ec5da7b95508fe987276)
        ;

        
    
    
            marker_394e7ee79b2984c9b4f6f02df01346b9.bindTooltip(
                `<div>
                     Battle of Hue
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_a3139f9e5d4be2186b117d134cee3545 = L.marker(
                [10.7772366108138, 106.69536647283701],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_44cfc93f96918229b82b53d114e05132 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_27992a646463679982f4974241234851 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk5nbyBEaW5oIERpZW0gYXNzYXNzaW5hdGlvbjwvc3Ryb25nPjxicj5OZ28gRGluaCBEaWVtIHdhcyB0aGUgU291dGggVmlldG5hbSBwcmVzaWRlbnQgaW4gMTk1NSBhZnRlciBhIGNvbnRyb2xsZWQgcmVmZXJlbmR1bSBhZ2FpbnN0IHRoZSBCYW8gRGFpLCB0aGUgbGFzdCBlbXBlcm9yIG9mIFZpZXRuYW0uIFdpdGggdGhlIHN1cHBvcnQgb2YgdGhlIFVTLCBEaWVtIGhhZCByZXNldHRsZWQgaHVuZHJlZHMgb2YgdGhvdXNhbmRzIG9mIHJlZnVnZWVzIGVzY2FwZWQgZnJvbSBOb3J0aCBWaWV0bmFtLiBEZXNwaXRlIHRoZSBhbGxpYW5jZSB3aXRoIHRoZSBVUyBhbmQgRGllbeKAmXMgcGVyc29uYWwgaGF0cmVkIHRvIGNvbW11bmlzbSwgaGlzIHByZXNpZGVuY3kgc2hvd24gbWFueSBjaGFyYWN0ZXJpc3RpY3Mgb2YgYSBkaWN0YXRvcnNoaXAuIEZyb20gY29uc29saWRhdGluZyBwb3dlciB3aXRoaW4gaGlzIGZhbWlseSwgZGlzY3JpbWluYXRpbmcgQnVkZGhpc3RzIG92ZXIgQ2F0aG9saWNzIGluIGEgQnVkZGhpc3QgY291bnRyeSB0byBmYWlsaW5nIHRvIGltcGxlbWVudCBsYW5kIHJlZm9ybXMgYW5kIHN1cHByZXNzaW9uIG9mIHBvbGl0aWNhbCBvcHBvc2l0aW9uLiBBbGwgb2YgdGhlc2UgZmFjdG9ycyBsZWQgdG8gdGhlIFVTIG9yZGVyaW5nIERpZW3igJlzIGdlbmVyYWxzIHRvIGFzc2Fzc2luYXRlIGhpbSBpbiBhIGNvdXAgZOKAmcOpdGF0IG9uIDJuZCBOb3ZlbWJlciAxOTYzLgpTb3VyY2U6IGh0dHBzOi8vd3d3LmJyaXRhbm5pY2EuY29tL2Jpb2dyYXBoeS9OZ28tRGluaC1EaWVtPGJyPjxpbWcgc3JjPSdodHRwczovL2xoNS5nb29nbGV1c2VyY29udGVudC5jb20vcC9BRjFRaXBNU3cyLWV2VUQwbjBpYlFMWGtrdGh6RndPaERjdDU5aVZ2UUxBPXc0MDgtaDMwNi1rLW5vJyBhbHQ9J2hpc3RfaW1nJyB3aWR0aD0nMjcwcHgnPg==&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_44cfc93f96918229b82b53d114e05132.setContent(i_frame_27992a646463679982f4974241234851);
            
        

        marker_a3139f9e5d4be2186b117d134cee3545.bindPopup(popup_44cfc93f96918229b82b53d114e05132)
        ;

        
    
    
            marker_a3139f9e5d4be2186b117d134cee3545.bindTooltip(
                `<div>
                     Ngo Dinh Diem assassination
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_b502bbfa36e341092c3a2f0644a06a24 = L.marker(
                [10.816673671427983, 106.64435715018435],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_b80dcc5fa5d026f9fe6d7865f94b3270 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_09e10b8197381958187b50a3b3886a7a = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPlRoZSBmYWxsIG9mIFNhaUdvbiBpbiAxOTc1PC9zdHJvbmc+PGJyPlRoZSBGYWxsIG9mIFNhaSBHb24gbWFya2VkIHRoZSBlbmQgb2YgYSAyLWRlY2FkZSB3YXIgYmV0d2VlbiBWaWV0bmFtIGFuZCBBbWVyaWNhLiBJbiB0aGUgZmluYWwgc3RhZ2VzIG9mIHRoZSB3YXIsIHRoZSBOb3J0aCBWaWV0bmFtIGFybXksIGFuZCB0aGUgVmlldCBDb25nIGNhcHR1cmUgY2l0eSBhZnRlciBjaXR5LiBUaGlzIHdhcyBkdWUgdG8gUHJlc2lkZW50IE5peG9uIHBvbGljeSBvZiBWaWV0bmFtaXphdGlvbiB3aGVyZSB0aGUgQW1lcmljYW4gd291bGQgdHJhaW4gYW5kIGVxdWlwIHRoZSBTb3V0aCBWaWV0bmFtZXNlIG1pbGl0YXJ5IHRvIHRha2Ugb3ZlciB0aGUgY29uZHVjdCBvZiB0aGUgd2FyLCBhbmQgZ3JhZHVhbGx5IHJlZHVjZSB0aGUgQW1lcmljYW4gYXJteSBhbmQgc3VwcG9ydC4gV2l0aCB0aGUgYWxyZWFkeSB1bnN0YWJsZSBTb3V0aCBWaWV0bmFtLCBjb3VwbGUgd2l0aCB0aGUgQW1lcmljYW4gd2VyZSBsZWF2aW5nLCBsZWZ0IHRoZSBTb3V0aCBWaWV0bmFtIHRvIGJlIHZ1bG5lcmFibGUgdG8gdGhlIGF0dGFja3Mgb2YgTm9ydGggVmlldG5hbSBhbmQgZXZlbnR1YWxseSBsZWQgdG8gdGhlaXIgZGVtaXNlLgpTb3VjZTogaHR0cHM6Ly93d3cuaGlzdG9yeS5jb20vdG9waWNzL3ZpZXRuYW0td2FyL3ZpZXRuYW1pemF0aW9uPGJyPjxpbWcgc3JjPSdodHRwczovL2FwaS50aW1lLmNvbS93cC1jb250ZW50L3VwbG9hZHMvMjAxNS8wNC9zYWlnb24uanBlZz9xdWFsaXR5PTg1Jnc9MTA4MCcgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_b80dcc5fa5d026f9fe6d7865f94b3270.setContent(i_frame_09e10b8197381958187b50a3b3886a7a);
            
        

        marker_b502bbfa36e341092c3a2f0644a06a24.bindPopup(popup_b80dcc5fa5d026f9fe6d7865f94b3270)
        ;

        
    
    
            marker_b502bbfa36e341092c3a2f0644a06a24.bindTooltip(
                `<div>
                     The fall of SaiGon in 1975
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_99f6e62e8ba6a5e868696b77f292368e = L.marker(
                [19.986955480290767, 107.75467673613805],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_8367659e376e8df467cb44bb5cfb3f0f = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_3b4bb890748a678644bd309f6d8138f9 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPkd1bGYgb2YgVG9ua2luIEluY2lkZW50IGluIDE5NjQ8L3N0cm9uZz48YnI+VHdvIEFtZXJpY2FuIGRlc3Ryb3llcnMgVVNTIE1hZGRveCBhbmQgVVNTIFR1cm5lciBKb3Ugd2VyZSBjb25kdWN0aW5nIGludGVsbGlnZW5jZS1nYXRoZXJpbmcgb3BlcmF0aW9ucyBpbiB0aGUgR3VsZiBvZiBUb25raW4uIE9uIHRoZSAybmQgb2YgQXVndXN0LCB0aGUgTWFkZG94IHdhcyBiZWluZyBhcHByb2FjaGVkIGJ5IDMgTm9ydGggVmlldG5hbWVzZSB0b3JwZWRvIGJvYXRzLiBUaGUgTWFkZG94IGZpcmVkIGEgd2FybmluZyBzaG90LCBidXQgdGhlIHRvcnBlZG8gYm9hdHMgb3BlbmVkIGZyaWVkLiBUaGlzIGxlZCB0byB0aGUgaW50ZXJ2ZW50aW9uIG9mIEFtZXJpY2FuIGFpciBzdXBwb3J0IGFuZCB0aGUgVVMgdG8gYmVsaWV2ZSB0aGUgTm9ydGggVmlldG5hbSB3YXMgdGFyZ2V0aW5nIHRoZWlyIGludGVsbGlnZW5jZSBnYXRoZXJpbmcgbWlzc2lvbi4gMiBkYXlzIGFmdGVyIHRoYXQsIG9uIGEgc3Rvcm15IG5pZ2h0IGJvdGggdGhlIGRlc3Ryb3llcnMgd2VyZSBvcGVyYXRpbmcgaW4gdGhlIGd1bGYgb2YgVG9ua2luIHdoZW4gdGhleSByZXBvcnRlZCBkZXRlY3RpbmcgbXVsdGlwbGUgdW5pZGVudGlmaWVkIHZlc3NlbHMgYXBwcm9hY2hpbmcgdGhlbS4gVGhleSBvcGVuIGZpcmVkIHdoZW4gY2FsbGVkIGluIGFpciBzdXBwb3J0LiBCdXQgaW4gYWN0dWFsaXR5LCB0aGVyZSB3ZXJlIG5vIGVuZW15IGJvYXRzIHRvIGJlIGZvdW5kLiBUaGVzZSB0d28gaW5jaWRlbnRzIGhhZCBsZWQgdG8gdGhlIENvbmdyZXNzIHBhc3NpbmcgdGhlIEd1bGYgb2YgVG9ua2luIFJlc29sdXRpb24gZ3JhbnRpbmcgUHJlc2lkZW50IEpvaG5zb24gdGhlIGVzY2FsYXRlIHRoZSBVUyBtaWxpdGFyeSBwcmVzZW5jZSBpbiBWaWV0bmFtLgpTb3JjZTogaHR0cHM6Ly93d3cuYnJpdGFubmljYS5jb20vZXZlbnQvR3VsZi1vZi1Ub25raW4taW5jaWRlbnQ8YnI+PGltZyBzcmM9J2h0dHBzOi8vbGg1Lmdvb2dsZXVzZXJjb250ZW50LmNvbS9wL0FGMVFpcFB4UU1qMUd1aFNFMFVESjhoRWpWbFlnam90QXFjdVdhLXRvYV9GPXc0MDgtaDMwNi1rLW5vJyBhbHQ9J2hpc3RfaW1nJyB3aWR0aD0nMjcwcHgnPg==&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_8367659e376e8df467cb44bb5cfb3f0f.setContent(i_frame_3b4bb890748a678644bd309f6d8138f9);
            
        

        marker_99f6e62e8ba6a5e868696b77f292368e.bindPopup(popup_8367659e376e8df467cb44bb5cfb3f0f)
        ;

        
    
    
            marker_99f6e62e8ba6a5e868696b77f292368e.bindTooltip(
                `<div>
                     Gulf of Tonkin Incident in 1964
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_4fb3a44c6500e6d7fe4c5c7c08295209 = L.marker(
                [19.3092, 103.9235],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_bec35f97a0104773fee7138257d94661 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_ca82a5d4ee0f80b02f0bfa3fc6a88371 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk9wZXJhdGlvbiBQb3BleWU8L3N0cm9uZz48YnI+T3BlcmF0aW9uIFBvcGV5ZSBvciBQcm9qZWN0IFBvcGV5ZSB3YXMgYSB3ZWF0aGVyIG1vZGlmaWNhdGlvbiBwcm9ncmFtIHVzZWQgYnkgdGhlIFVTIGluIHRoZSBWaWV0bmFtIFdhci4gVGhlIEFtZXJpY2FuIHNlbnQgYXJvdW5kIDI2MDAgY2xvdWQgc2VlZGluZyAoYSB0ZWNobmlxdWUgdG8gaW1wcm92ZSB0aGUgY2xvdWRz4oCZIGFiaWxpdHkgdG8gcHJvZHVjZSByYWluKSBvbiBhIHBhcnQgb2YgdGhlIEhvIENoaSBNaW5oIFRyYWlsLCBuZWFyIHRoZSBib3JkZXIgb2YgVmlldG5hbSwgTGFvcywgQ2FtYm9kaWEuIFRoZSBvYmplY3RpdmUgb2YgdGhlIG9wZXJhdGlvbiB3YXMgdG8gZXh0ZW5kIHRoZSBtb25zb29uIHNlYXNvbiBmaXIgMzAgdG8gNDUgZGF5cyBpbiBvcmRlciB0byBkaXNydXB0IHRoZSBzdXBwbHkgbGluZSBvZiB0aGUgVmlldG5hbWVzZS4KU291cmNlLiBodHRwczovL3BvbGFycGVkaWEuZXUvZW4vb3BlcmF0aW9uLXBvcGV5ZS88YnI+PGltZyBzcmM9J2h0dHBzOi8vOTlwZXJjZW50aW52aXNpYmxlLm9yZy9hcHAvdXBsb2Fkcy8yMDE4LzAzL3RyYWlsLXVzYWdlLmpwZycgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_bec35f97a0104773fee7138257d94661.setContent(i_frame_ca82a5d4ee0f80b02f0bfa3fc6a88371);
            
        

        marker_4fb3a44c6500e6d7fe4c5c7c08295209.bindPopup(popup_bec35f97a0104773fee7138257d94661)
        ;

        
    
    
            marker_4fb3a44c6500e6d7fe4c5c7c08295209.bindTooltip(
                `<div>
                     Operation Popeye
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_32c097b43411005240cc67025a1acc46 = L.marker(
                [18.2048, 103.4167],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_994728cc24dde135dec7f599a7b52f39 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_9a615462c74e4dc677c7f0e0b1aa3ee1 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk9wZXJhdGlvbiBQb3BleWU8L3N0cm9uZz48YnI+T3BlcmF0aW9uIFBvcGV5ZSBvciBQcm9qZWN0IFBvcGV5ZSB3YXMgYSB3ZWF0aGVyIG1vZGlmaWNhdGlvbiBwcm9ncmFtIHVzZWQgYnkgdGhlIFVTIGluIHRoZSBWaWV0bmFtIFdhci4gVGhlIEFtZXJpY2FuIHNlbnQgYXJvdW5kIDI2MDAgY2xvdWQgc2VlZGluZyAoYSB0ZWNobmlxdWUgdG8gaW1wcm92ZSB0aGUgY2xvdWRz4oCZIGFiaWxpdHkgdG8gcHJvZHVjZSByYWluKSBvbiBhIHBhcnQgb2YgdGhlIEhvIENoaSBNaW5oIFRyYWlsLCBuZWFyIHRoZSBib3JkZXIgb2YgVmlldG5hbSwgTGFvcywgQ2FtYm9kaWEuIFRoZSBvYmplY3RpdmUgb2YgdGhlIG9wZXJhdGlvbiB3YXMgdG8gZXh0ZW5kIHRoZSBtb25zb29uIHNlYXNvbiBmaXIgMzAgdG8gNDUgZGF5cyBpbiBvcmRlciB0byBkaXNydXB0IHRoZSBzdXBwbHkgbGluZSBvZiB0aGUgVmlldG5hbWVzZS4KU291cmNlLiBodHRwczovL3BvbGFycGVkaWEuZXUvZW4vb3BlcmF0aW9uLXBvcGV5ZS88YnI+PGltZyBzcmM9J2h0dHBzOi8vOTlwZXJjZW50aW52aXNpYmxlLm9yZy9hcHAvdXBsb2Fkcy8yMDE4LzAzL3RyYWlsLXVzYWdlLmpwZycgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_994728cc24dde135dec7f599a7b52f39.setContent(i_frame_9a615462c74e4dc677c7f0e0b1aa3ee1);
            
        

        marker_32c097b43411005240cc67025a1acc46.bindPopup(popup_994728cc24dde135dec7f599a7b52f39)
        ;

        
    
    
            marker_32c097b43411005240cc67025a1acc46.bindTooltip(
                `<div>
                     Operation Popeye
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_22dfa4a8e066c885fd93d75f3d686fa6 = L.marker(
                [10.5763, 105.2094],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_1cbeedc24ee1a22be4579e828430baac = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_db52b9b4be57aea72fb8dcd69e3b4fd9 = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk9wZXJhdGlvbiBQb3BleWU8L3N0cm9uZz48YnI+T3BlcmF0aW9uIFBvcGV5ZSBvciBQcm9qZWN0IFBvcGV5ZSB3YXMgYSB3ZWF0aGVyIG1vZGlmaWNhdGlvbiBwcm9ncmFtIHVzZWQgYnkgdGhlIFVTIGluIHRoZSBWaWV0bmFtIFdhci4gVGhlIEFtZXJpY2FuIHNlbnQgYXJvdW5kIDI2MDAgY2xvdWQgc2VlZGluZyAoYSB0ZWNobmlxdWUgdG8gaW1wcm92ZSB0aGUgY2xvdWRz4oCZIGFiaWxpdHkgdG8gcHJvZHVjZSByYWluKSBvbiBhIHBhcnQgb2YgdGhlIEhvIENoaSBNaW5oIFRyYWlsLCBuZWFyIHRoZSBib3JkZXIgb2YgVmlldG5hbSwgTGFvcywgQ2FtYm9kaWEuIFRoZSBvYmplY3RpdmUgb2YgdGhlIG9wZXJhdGlvbiB3YXMgdG8gZXh0ZW5kIHRoZSBtb25zb29uIHNlYXNvbiBmaXIgMzAgdG8gNDUgZGF5cyBpbiBvcmRlciB0byBkaXNydXB0IHRoZSBzdXBwbHkgbGluZSBvZiB0aGUgVmlldG5hbWVzZS4KU291cmNlLiBodHRwczovL3BvbGFycGVkaWEuZXUvZW4vb3BlcmF0aW9uLXBvcGV5ZS88YnI+PGltZyBzcmM9J2h0dHBzOi8vOTlwZXJjZW50aW52aXNpYmxlLm9yZy9hcHAvdXBsb2Fkcy8yMDE4LzAzL3RyYWlsLXVzYWdlLmpwZycgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_1cbeedc24ee1a22be4579e828430baac.setContent(i_frame_db52b9b4be57aea72fb8dcd69e3b4fd9);
            
        

        marker_22dfa4a8e066c885fd93d75f3d686fa6.bindPopup(popup_1cbeedc24ee1a22be4579e828430baac)
        ;

        
    
    
            marker_22dfa4a8e066c885fd93d75f3d686fa6.bindTooltip(
                `<div>
                     Operation Popeye
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_344792011c9590d88117b683540b49e7 = L.marker(
                [21.57235955732699, 103.09442549952763],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_0f5040468cfff9dc6fa70dd7964ee368 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_208caad3fc9e934e9b29249dd6bb4e0a = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPkJhdHRsZSBvZiBEaWVuIEJpZW4gUGh1PC9zdHJvbmc+PGJyPkRpZW4gQmllbiBQaHUgVmFsbGV5IHdhcyBhIG1pbGl0YXJ5IHN0cm9uZ2hvbGQgb2YgdGhlIEZyZW5jaCBkdXJpbmcgdGhlIEZpcnN0IEluZG9jaGluYSBXYXIgYmV0d2VlbiBGcmFuY2UgYW5kIFZpZXRuYW0uIFRoZSByZWFzb25zIGZvciBGcmFuY2Ugb2NjdXBhdGlvbiBvZiBEaWVuIEJpZW4gUGh1IHdlcmUgdG8gZGVzdHJveSB0aGUgc3VwcGx5IGxpbmVzIG9mIFZpZXRuYW0gZnJvbSBMYW9zIGFuZCBmb3JjZSB0aGUgVmlldCBNaW5oIHRvIGFuIG9wZW4gYXR0YWNrLiBVbmRlciB0aGUgbGVhZGVyc2hpcCBvZiBnZW5lcmFsIFZvIE5ndXllbiBHaWFwLCB0aGUgVmlldCBNaW5oIGFybXkgc3Vycm91bmQgdGhlIHZhbGxleS4gVGhleSBkdWcgb3V0IG1hbnkgYXJ0aWxsZXJ5IHBvc2l0aW9ucyBvbiBzdGVlcCBzbG9wZXMuIE9uIE1hcmNoIDEzLCAxOTU0LCBWaWV0IE1pbmggc3RhcnRlZCB0aGVpciBhdHRhY2tzLiBGb3IgdGhlIG5leHQgdHdvIG1vbnRocywgdGhlIFZpZXRuYW1lc2UgYXR0YWNrZWQgdGhlIEZyZW5jaCB1c2luZyBhcnRpbGxlcnkgZmlyZSBhbmQgdHJlbmNoIHdhcmZhcmUgdG8gaXNvbGF0ZSB0aGUgRnJlbmNoIGdhcnJpc29ucy4gVGhpcyBjYXVzZWQgdGhlIEZyZW5jaCB0byBsb3NlIHRoZWlyIG91dHBvc3RzLCBhaXJzdHJpcHMsIGFuZCBtYW55IGRhbWFnZWQgYWlyY3JhZnRzLiBUaGUgZmluYWwgdmljdG9yeSBiZWxvbmdzIHRvIHRoZSBWaWV0bmFtZXNlLCBidXQgdGhlIGh1bWFuIHRvbGwgb24gYm90aCBzaWRlcyB3YXMgdHJlbWVuZG91cywgd2l0aCB0aGUgRnJlbmNoIGxvc2luZyAyMjAwIHNvbGRpZXJzIGluIGFjdGlvbnMgYW5kIGFub3RoZXIgMzMwMCBwcmlzb25lcnMgZGllZCBvbiBjYXB0aXZpdHkuIEFmdGVyIHRoZSBiYXR0bGUsIHRoZSBGcmFuY2UgYW5kIFZpZXRuYW0gaGFkIGEgY29uZmVyZW5jZSBuYW1lZCBHZW5ldmEgaW4gSnVseSBvZiAxOTU0IGZvciBwZWFjZSB0YWxrcy4gVGhlIHRlcm1zIG9mIHRoZSBwZWFjZSBhZ3JlZW1lbnQgY2FsbGVkIGZvciB0ZW1wb3JhcnkgcGFydGl0aW9uIG9mIE5vcnRoIGFuZCBTb3V0aCBWaWV0bmFtLiBUaGUgTm9ydGggd2FzIHRoZSBDb21tdW5pc3Qgc2lkZSB3aXRoIHRoZSBzdXBwb3J0ZWQgb2YgVVNTUiBhbmQgQ2hpbmEgd2hpbGUgdGhlIFNvdXRoIGhhZCB0aGUgc3VwcG9ydGVkIG9mIHRoZSBVUyBhbmQgc29tZSBvZiB0aGUgYWxsaWVzLiBUaGVzZSBldmVudHMgdWx0aW1hdGVseSBsZWQgdG8gdGhlIFZpZXRuYW0gV2FyIG9yIFNlY29uZCBJbmRvY2hpbmEgV2FyLgpTb3VyY2U6IGh0dHBzOi8vd3d3Lmhpc3RvcnkuY29tL3RvcGljcy9ldXJvcGVhbi1oaXN0b3J5L2JhdHRsZS1vZi1kaWVuLWJpZW4tcGh1PGJyPjxpbWcgc3JjPSdodHRwczovL2Fzc2V0cy5lZGl0b3JpYWwuYWV0bmQuY29tL3VwbG9hZHMvMjAwOS8xMC9iYXR0bGUtb2YtZGllbi1iaWVuLXBodS1nZXR0eWltYWdlcy01NDgxOTE3NDcuanBnP3dpZHRoPTE5MjAmaGVpZ2h0PTk2MCZjcm9wPTE5MjAlM0E5NjAlMkNzbWFydCZxdWFsaXR5PTc1JmF1dG89d2VicCcgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_0f5040468cfff9dc6fa70dd7964ee368.setContent(i_frame_208caad3fc9e934e9b29249dd6bb4e0a);
            
        

        marker_344792011c9590d88117b683540b49e7.bindPopup(popup_0f5040468cfff9dc6fa70dd7964ee368)
        ;

        
    
    
            marker_344792011c9590d88117b683540b49e7.bindTooltip(
                `<div>
                     Battle of Dien Bien Phu
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_fdc5191009120ea2938d7bdcdf4e7ee4 = L.marker(
                [10.59194693146919, 104.92222286168393],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_7b6aab247692604ba236382893fc2a99 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_6b832c05fa41b207fb2d314c75ddc1fc = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPkJhIENodWMgbWFzc2FjcmU8L3N0cm9uZz48YnI+S2htZXIgUm91Z2UsIGEgdGVycm9yIHJlZ2ltZSBsZWQgYnkgUG9sIFBvdCB3aGljaCBraWxsZWQgbWlsbGlvbnMgb2YgQ2FtYm9kaWFucyB3aGljaCBzb3VnaHQgVmlldG5hbSB3YXMgdGhlaXIgbmV4dCB0YXJnZXQuIEFmdGVyIHRoZWlyIGRlZmVhdHMgaW4gMTk3NyB3aGVyZSB0aGUgS2htZXIgUm91Z2Uga2lsbGVkIDEwMDAgVmlldG5hbWVzZSwgYW5kIFZpZXRuYW0gcmV0YWxpYXRlZCBieSBsYXVuY2hpbmcgc2V2ZXJhbCBzdWNjZXNzZnVsIGNhbXBhaWducywgdGhlIEtobWVyIFJvdWdlIGNhbWUgYmFjayBpbiAxOTc4LiBJbiBBcHJpbCBvZiB0aGF0IHllYXIsIHRoZXkgY3Jvc3NlZCB0aGUgYm9yZGVyIGFuZCBhdHRhY2tlZCBCYSBDaHVjIHZpbGxhZ2UuIE9ubHkgMTIgZGF5cywgdGhleSBtYXNzIG11cmRlcmVkIDMwMDAgVmlldG5hbWVzZSBhbmQgdGhlcmUgd2VyZSBvbmx5IDIga25vd24gc3Vydml2b3JzLiBUaGVzZSBjYXVzZWQgVmlldG5hbSB0byBhdHRhY2sgZnVsbCBmb3JjZSBhbmQgY2FwdHVyZSBQaG5vbSBQZW5oICh0aGUgY2FwaXRhbCBvZiBDYW1ib2RpYSkgaW4gSmFudWFyeSBvZiAxOTc5LCBlbmRpbmcgdGhlIFBvbCBQb3QgcmVnaW1lLiBDaGluYSwgd2hvIHN1cHBvcnRlZCB0aGUgS2htZXIgUm91Z2UgZmluYW5jaWFsLCBmZWFyZWQgdGhlIGV4cGFuc2lvbiBvZiBWaWV0bmFtLCBzdGFydGVkIGEgU2luby1WaWV0bmFtZXNlIFdhciB3aGljaCBsYXN0ZWQgZm9yIDI3IGRheXMuClNvdXJjZTogaHR0cHM6Ly9zb2xvdHJhdmVsbGVyb250b3VyLmNvbS9tZWtvbmctZGVsdGEtYm9yZGVyLWxvb3AtYmEtY2h1Yy10b21iLzxicj48aW1nIHNyYz0naHR0cHM6Ly90b2RheWluaGlzdG9yeS5ibG9nL3dwLWNvbnRlbnQvdXBsb2Fkcy8yMDE5LzAxL2tpbGxpbmdmaWVsZHMtZnQtMS5tLmpwZz93PTg0MCcgYWx0PSdoaXN0X2ltZycgd2lkdGg9JzI3MHB4Jz4=&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_7b6aab247692604ba236382893fc2a99.setContent(i_frame_6b832c05fa41b207fb2d314c75ddc1fc);
            
        

        marker_fdc5191009120ea2938d7bdcdf4e7ee4.bindPopup(popup_7b6aab247692604ba236382893fc2a99)
        ;

        
    
    
            marker_fdc5191009120ea2938d7bdcdf4e7ee4.bindTooltip(
                `<div>
                     Ba Chuc massacre
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_1f39c6485f50494c7f181b8c992cf24b = L.marker(
                [15.266432532765865, 108.87073271815387],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_fa0a7e9282441afc28af6b15bf19521c = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_13c8417e38ea26522c96f7eaeaecf6fc = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk15IExhaSBtYXNzYWNyZTwvc3Ryb25nPjxicj5BZnRlciB0aGUgVGV0IE9mZmVuc2l2ZSwgdGhlIEFtZXJpY2FuIHNvbGRpZXJz4oCZIG1vcmFsZSB3YXMgZHdpbmRsaW5nLCBhbmQgdGhleSBoZWFyZCB3b3JkcyB0aGF0IHRoZSBWaWV0IENvbmcgd2FzIGhpZGluZyBpbnNpZGUgdmlsbGFnZSBNeSBMYWkgaW4gU29uIE15LiBUaGUgQW1lcmljYW5zIHRoZW4gc2VudCBzb2xkaWVycyB0byB0aGUgdmlsbGFnZSB0byBpbnZlc3RpZ2F0ZSBidXQgZm91bmQgb25seSBjaGlsZHJlbiwgd29tZW4sIG9sZCBtZW4sIGFuZCBsaXR0bGUgdG8gbm8gd2VhcG9ucy4gTm9uZXRoZWxlc3MsIHRoZSBXaWxsaWFtIENhbGxleSwgdGhlIGNvbW1hbmRlciBvZiB0aGUgcmFpZCwgb3JkZXJlZCBoaXMgbWVuIHRvIHNob290IHRoZSB2aWxsYWdlcnMuIE9uIHRoYXQgZGF5LCBNYXJjaCAxNiwgMTk2OCwgbW9yZSB0aGFuIDUwMCBwZW9wbGUgd2VyZSBzbGF1Z2h0ZXJlZCB3aXRoIG1hbnkgeW91bmcgZ2lybHMgYW5kIHdvbWVuIHdlcmUgcmFwZWQgYW5kIHRoZW4ga2lsbGVkLiBUaGUgYnJ1dGFsaXR5IG9mIE15IExhaSBtYXNzYWNyZSB3YXMgY292ZXJlZCBieSBhIHllYXIgdW50aWwgaXQgd2FzIGV4cG9zZWQsIGFuZCB0aGlzIGZ1ZWxsZWQgYW50aS13YXIgc2VudGltZW50IGFuZCBmdXJ0aGVyIGRpdmlkZWQgdGhlIFVTIG92ZXIgdGhlIFZpZXRuYW0gV2FyLgpTb3VyY2U6IGh0dHBzOi8vd3d3Lmhpc3RvcnkuY29tL3RvcGljcy92aWV0bmFtLXdhci9teS1sYWktbWFzc2FjcmUtMTxicj48aW1nIHNyYz0naHR0cHM6Ly9saDUuZ29vZ2xldXNlcmNvbnRlbnQuY29tL3AvQUYxUWlwUGcwd3RWRTRlOC1mRjRkakJOSG9PMDJMamJZTEpHV1B3d1IzMTY9dzQwOC1oMzA2LWstbm8nIGFsdD0naGlzdF9pbWcnIHdpZHRoPScyNzBweCc+&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_fa0a7e9282441afc28af6b15bf19521c.setContent(i_frame_13c8417e38ea26522c96f7eaeaecf6fc);
            
        

        marker_1f39c6485f50494c7f181b8c992cf24b.bindPopup(popup_fa0a7e9282441afc28af6b15bf19521c)
        ;

        
    
    
            marker_1f39c6485f50494c7f181b8c992cf24b.bindTooltip(
                `<div>
                     My Lai massacre
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var marker_2be2bbf7d70d617b4731c406fee01c27 = L.marker(
                [15.792439795074536, 108.11623074979195],
                {}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
    
        var popup_0ae6e802c0c6d8b2124ed2850b3494b2 = L.popup({&quot;maxWidth&quot;: 400});

        
            
                var i_frame_37fa136b2565e7ffe9f582bc61c8dddf = $(`<iframe src=&quot;data:text/html;charset=utf-8;base64,CiAgICA8c3Ryb25nPk15IFNvbiBTYW5jdHVhcnk8L3N0cm9uZz48YnI+TXkgU29uIFNhbmN0dWFyeSBpcyBhIHJlbW5hbnQgb2YgdGhlIHJlbGlnaW91cyBhbmQgcG9saXRpY2FsIGNhcGl0YWwgb2YgdGhlIENoYW1wYSBLaW5nZG9tIHRoYXQgcnVsZWQgb3ZlciBjZW50cmFsIFZpZXRuYW0gYmV0d2VlbiB0aGUgNHRoIGFuZCAxM3RoIGNlbnR1cmllcy4gVGhlIHBlb3BsZSBvZiBDaGFtIG9yaWdpbmF0ZWQgZnJvbSBJbmRpYSBhbmQgdGhlIHJlbW5hbnQgc2hvd3MgaW1wcmVzc2l2ZSB0b3dlciB0ZW1wbGVzIGluZmx1ZW5jZWQgYnkgSGluZHVpc20uClNvdXJjZTogaHR0cHM6Ly93aGMudW5lc2NvLm9yZy9lbi9saXN0Lzk0OS88YnI+PGltZyBzcmM9J2h0dHBzOi8vbGg1Lmdvb2dsZXVzZXJjb250ZW50LmNvbS9wL0FGMVFpcE9KQjRnb3BEb3lkNW5wVldScGoxNTBYTVpUX3Y1MkVIcGphOU5RPXc0MDgtaDMwNS1rLW5vJyBhbHQ9J2hpc3RfaW1nJyB3aWR0aD0nMjcwcHgnPg==&quot; width=&quot;300&quot; style=&quot;border:none !important;&quot; height=&quot;300&quot;></iframe>`)[0];
                popup_0ae6e802c0c6d8b2124ed2850b3494b2.setContent(i_frame_37fa136b2565e7ffe9f582bc61c8dddf);
            
        

        marker_2be2bbf7d70d617b4731c406fee01c27.bindPopup(popup_0ae6e802c0c6d8b2124ed2850b3494b2)
        ;

        
    
    
            marker_2be2bbf7d70d617b4731c406fee01c27.bindTooltip(
                `<div>
                     My Son Sanctuary
                 </div>`,
                {&quot;sticky&quot;: true}
            );
        
    
            var poly_line_358e60a8034ea1ee9e20784d351a7320 = L.polyline(
                [[21.0285, 105.8542], [20.4855, 104.2375], [19.3092, 103.9235], [18.2048, 103.4167], [17.9725, 106.28], [17.2135, 106.1106], [16.261, 107.5807], [15.05, 108.5], [13.7563, 109.1996], [12.2388, 107.734], [11.5449, 104.8922], [10.5763, 105.2094], [10.8231, 106.6297]],
                {&quot;bubblingMouseEvents&quot;: true, &quot;color&quot;: &quot;red&quot;, &quot;dashArray&quot;: null, &quot;dashOffset&quot;: null, &quot;fill&quot;: false, &quot;fillColor&quot;: &quot;red&quot;, &quot;fillOpacity&quot;: 0.2, &quot;fillRule&quot;: &quot;evenodd&quot;, &quot;lineCap&quot;: &quot;round&quot;, &quot;lineJoin&quot;: &quot;round&quot;, &quot;noClip&quot;: false, &quot;opacity&quot;: 1, &quot;smoothFactor&quot;: 1.0, &quot;stroke&quot;: true, &quot;weight&quot;: 2.5}
            ).addTo(map_65457a04584bdce7d07acf3939caeee8);
        
</script>
</html>" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen=""></iframe></div></div>
</div>
</div>
<p>The map shows different events and locations from the <code>Post</code>. There are many interesting topics discussed and I have provide a summary for the majority of them on this Vietnam map. When you click on each of the marker, it will show the location and the event happened their. Also, the red line is the Ho Chi Minh Trail, the trail that sent North Vietnamese soilders and supplies into South Vietnam.</p>
</section>
<section id="emotion-detection-for-post" class="level2">
<h2 class="anchored" data-anchor-id="emotion-detection-for-post">Emotion detection for <code>Post</code></h2>
<section id="add-columns-from-df4" class="level3">
<h3 class="anchored" data-anchor-id="add-columns-from-df4">Add columns from <code>df4</code></h3>
<p>I will add the <code>PostId</code> for identification and <code>Post3</code> for emotion detection</p>
<div id="ea59c47b" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge and rearrange columns</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>df8 <span class="op">=</span> df7.merge(df4[[<span class="st">'PostId'</span>, <span class="st">'Post'</span>, <span class="st">'Post3'</span>]], </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                left_on<span class="op">=</span><span class="st">'Original Post'</span>, right_on<span class="op">=</span><span class="st">'Post'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>df8 <span class="op">=</span> df8.drop_duplicates([<span class="st">'PostId'</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>df8.drop([<span class="st">'Post'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>df8.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>229</td>
<td>what happen in the aftermath of the Tet offens...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="testing-out-the-model" class="level3">
<h3 class="anchored" data-anchor-id="testing-out-the-model">Testing out the model</h3>
<p>Here is the model I will be using: <code>https://huggingface.co/cardiffnlp/twitter-roberta-base-emotion-multilabel-latest</code></p>
<div id="f0d106b9" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> transformers <span class="im">import</span> pipeline, AutoTokenizer</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">"cardiffnlp/twitter-roberta-base-emotion-multilabel-latest"</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>emotionModel <span class="op">=</span> pipeline(<span class="st">"text-classification"</span>, model<span class="op">=</span>model_name)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> AutoTokenizer.from_pretrained(model_name)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> emotionModel(df8.Post3[<span class="dv">0</span>])</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>display(df8.Post3[<span class="dv">0</span>], label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING:tensorflow:From C:\Users\tomde\AppData\Local\Programs\Python\Python311\Lib\site-packages\tf_keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.
</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>'what happen in the aftermath of the Tet offensive to the Viet Cong ?   be it actually break or do it just incorporate into the North Viet Nam army ? \n\n Edit : I be fully aware that the USA lose the Vietnam war .   I be not interested in reiteration of that fact .   what I be interested in be the operation against the Viet Cong .   the fact that the North invade the South and take over be not debatable .   but how much be the Viet Cong part of that victory ? how much do it contribute to it or be it eradicate / assimilate into the North Vietnam army ?  \n\n this question focus on the counter insurgency part of the war which could be win but the overall war lose -- again , I know the USA lose the Vietnam war . \n'</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[{'label': 'anticipation', 'score': 0.5553023219108582}]</code></pre>
</div>
</div>
</section>
<section id="apply-emotion-detection-to-post2" class="level3">
<h3 class="anchored" data-anchor-id="apply-emotion-detection-to-post2">Apply Emotion detection to <code>Post2</code></h3>
<section id="concepts-explain" class="level4">
<h4 class="anchored" data-anchor-id="concepts-explain">Concepts explain</h4>
<ul>
<li><strong>Tokenize</strong>: convert a string of text into individual pieces known as tokens. Tokens can be words, subwords and characters. Example:
<ul>
<li>Text: “Hello, world!”</li>
<li>Tokens: [“Hello”, “,”, “world”, “!”] or [7592, 1010, 2088, 999] if the tokens are in pytorch tensors</li>
</ul></li>
<li><strong>Decode</strong>: convert tokens into human language. Example
<ul>
<li>Tokens: [7592, 1010, 2088, 999]</li>
<li>Decoded Text: “Hello, world!”</li>
</ul></li>
<li><strong>Yield</strong>: return values one at a time from a function, allowing it to be used as an iterator</li>
</ul>
</section>
<section id="example-of-yield" class="level4">
<h4 class="anchored" data-anchor-id="example-of-yield">Example of <code>yield</code></h4>
<div id="a63cf06d" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generator_function():</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="dv">1</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="dv">2</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="dv">3</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generator_function())</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> value <span class="kw">in</span> generator_function():</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;generator object generator_function at 0x0000023FA0983740&gt;
1
2
3</code></pre>
</div>
</div>
</section>
<section id="split-the-post-into-chunk" class="level4">
<h4 class="anchored" data-anchor-id="split-the-post-into-chunk">Split the post into chunk</h4>
<div id="f86f1d53" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to split text into token-length constrained chunks</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_text(text, tokenizer, max_length):</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize text in form of pytorch tensors, truncation enabled and max length set</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> tokenizer(text, return_tensors<span class="op">=</span><span class="st">'pt'</span>, truncation<span class="op">=</span><span class="va">True</span>, max_length<span class="op">=</span>max_length)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the tokenized representation of the text</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> tokens[<span class="st">'input_ids'</span>][<span class="dv">0</span>].tolist()</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over input IDs in chunks of size `max_length`</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(input_ids), max_length):</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get a chunk of input IDs of length 'max_length'</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>        chunk_ids <span class="op">=</span> input_ids[i:i <span class="op">+</span> max_length]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Decode the chunk of input IDs back to text</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>        chunk_text <span class="op">=</span> tokenizer.decode(chunk_ids, skip_special_tokens<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Yield the chunk of text</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> chunk_text</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Example use case</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="dv">512</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>chunks <span class="op">=</span> <span class="bu">list</span>(split_text(df8.Post3[<span class="dv">0</span>], tokenizer, max_length)) <span class="co"># use `split_text` function to split text into chunks</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, chunk <span class="kw">in</span> <span class="bu">enumerate</span>(chunks):</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Chunk </span><span class="sc">{</span>index <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>chunk<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Chunk 1 what happen in the aftermath of the Tet offensive to the Viet Cong?   be it actually break or do it just incorporate into the North Viet Nam army? 

 Edit : I be fully aware that the USA lose the Vietnam war.   I be not interested in reiteration of that fact.   what I be interested in be the operation against the Viet Cong.   the fact that the North invade the South and take over be not debatable.   but how much be the Viet Cong part of that victory? how much do it contribute to it or be it eradicate / assimilate into the North Vietnam army?  

 this question focus on the counter insurgency part of the war which could be win but the overall war lose -- again, I know the USA lose the Vietnam war. 
</code></pre>
</div>
</div>
<p>The main function of the code block is to split the text from the post column into smaller token-length chunks. This is a necessary process as our model has a limitation on input sequence length.</p>
</section>
<section id="get-the-emotion-of-each-post" class="level4">
<h4 class="anchored" data-anchor-id="get-the-emotion-of-each-post">Get the emotion of each post</h4>
<div id="e6973f84" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get the dominant emotion from the a text</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_emotion(text):</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    max_length <span class="op">=</span> <span class="dv">512</span> <span class="co"># Max token length of the Roberta model is 512</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    emotions <span class="op">=</span> []</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use `split_text` function to split text into chunks</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chunk <span class="kw">in</span> split_text(text, tokenizer, max_length):</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict emotion for the current chunk</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> emotionModel(chunk)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the predicted emotion label to the `emotions` list</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        emotions.append(result[<span class="dv">0</span>][<span class="st">'label'</span>])</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the most frequence emotions in the emotion list for that text</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> emotions:</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(<span class="bu">set</span>(emotions), key<span class="op">=</span>emotions.count)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'neutral'</span> <span class="co"># return neutral of no emotion is found</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to the `Post` column</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>df8[<span class="st">'PostEmotion'</span>] <span class="op">=</span> df8[<span class="st">'Post3'</span>].<span class="bu">apply</span>(get_emotion)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>df8[<span class="st">'PostEmotion'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0     anticipation
1     anticipation
2          disgust
3          disgust
4          disgust
          ...     
69    anticipation
70    anticipation
71         disgust
72         sadness
73    anticipation
Name: PostEmotion, Length: 74, dtype: object</code></pre>
</div>
</div>
<p>The code block returns a most prominent emotion detected based on the given text from the <code>split_text</code> function. Then it find the most frequence emotions of that post and set it as the overall emotion of the post.</p>
</section>
</section>
<section id="look-for-the-most-prominent-emotion" class="level3">
<h3 class="anchored" data-anchor-id="look-for-the-most-prominent-emotion">Look for the most prominent emotion</h3>
<div id="831851a4" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>emotion_counts <span class="op">=</span> df8[<span class="st">'PostEmotion'</span>].value_counts()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>emotion_counts.index, y<span class="op">=</span>emotion_counts.values, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add titles and labels</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Counts of Different Emotions in Comments'</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Emotion'</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/cell-36-output-1.png" width="733" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since we are analyzing the <code>Post3</code> column, meaning that the texts are question type. People are curious on the subject of Vietnamese History so the prominent emotion is anticipation. Disgust is the second most prominent emotion, which is understandable because many of the questions are war type questions.</p>
</section>
</section>
<section id="look-for-keywords-in-comment" class="level2">
<h2 class="anchored" data-anchor-id="look-for-keywords-in-comment">Look for keywords in <code>Comment</code></h2>
<section id="merge-comments-data-from-df4" class="level3">
<h3 class="anchored" data-anchor-id="merge-comments-data-from-df4">Merge comments data from <code>df4</code></h3>
<p>I will add the comment columns our dataframe to look for keywords in each comment and for emotion detection.</p>
<div id="77a3360f" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge comments data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df9 <span class="op">=</span> df8.merge(df4[[<span class="st">'PostId'</span>, <span class="st">'Comment'</span>, <span class="st">'Comment2'</span>, <span class="st">'Comment3'</span>]], on<span class="op">=</span><span class="st">'PostId'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN rows in comments column with empty strings</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment'</span>] <span class="op">=</span> df9[<span class="st">'Comment'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment2'</span>] <span class="op">=</span> df9[<span class="st">'Comment2'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment3'</span>] <span class="op">=</span> df9[<span class="st">'Comment3'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>df9.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">PostEmotion</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Comment3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>229</td>
<td>what happen in the aftermath of the Tet offens...</td>
<td>anticipation</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>anticipation</td>
<td>The South was invaded in a regular war by the ...</td>
<td>South invaded regular war North</td>
<td>the South be invade in a regular war by the No...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="use-openai-to-find-if-there-is-anything-interesting-were-discussed-in-the-comments" class="level3">
<h3 class="anchored" data-anchor-id="use-openai-to-find-if-there-is-anything-interesting-were-discussed-in-the-comments">Use OpenAI to find if there is anything interesting were discussed in the <code>comments</code></h3>
<p>I can not read through all of the comments because there are quite a lot of them, I will use openai to look out for certain some keywords.</p>
<div id="35aa1054" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># client = openai.OpenAI(api_key="")</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># def comment_analyze(text):</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     response = client.chat.completions.create(</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         model="gpt-3.5-turbo",</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         messages=[</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#         {"role": "system", "content": "You are a expert in Vietnamese History. Return the keywords, events, characters related to Vietnamese History from this given text and nothing else. If the text is empty, return nothing"},</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         {"role": "user", "content": f"{text}"},</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#       ]</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     return response.choices[0].message.content</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># df9['Comment Keywords'] = df9['Comment'].dropna().apply(comment_analyze)</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co"># df9.to_csv('df9.csv', index=False)</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>df9 <span class="op">=</span> pd.read_csv(<span class="st">'df9.csv'</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>df9.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">PostEmotion</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Comment3</th>
<th data-quarto-table-cell-role="th">Comment Keywords</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>229</td>
<td>what happen in the aftermath of the Tet offens...</td>
<td>anticipation</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Vietnamese History</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>anticipation</td>
<td>The South was invaded in a regular war by the ...</td>
<td>South invaded regular war North</td>
<td>the South be invade in a regular war by the No...</td>
<td>Keywords: South, North, war, invasion\n\nEvent...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>anticipation</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>Ill forego lengthy analysis simply recommend b...</td>
<td>I will forego a lengthy analysis and simply re...</td>
<td>Keywords: Viet Nam, Nguyen Cao Ky, war</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>1466</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>disgust</td>
<td>Did you actually try to find some answer yours...</td>
<td>actually try find answer asking</td>
<td>do you actually try to find some answer yourse...</td>
<td>No keywords, events, or characters related to ...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>1466</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>disgust</td>
<td>I did some searching, but as far as I could fi...</td>
<td>searching far could find French interested rec...</td>
<td>I do some searching , but as far as I could fi...</td>
<td>Keywords: French, political, economic factors,...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>I have ran the code and saved the output to a <code>csv</code> file. I will import the <code>csv</code> file for convenient sake.</p>
</section>
</section>
<section id="analysis-on-the-keywords-from-openai-for-each-post-topic" class="level2">
<h2 class="anchored" data-anchor-id="analysis-on-the-keywords-from-openai-for-each-post-topic">Analysis on the keywords from openai for each post topic</h2>
<p>I will convert the content that gpt returns to string via <code>Post Topic</code> and look out for certain keywords relate to Vietnamese History.</p>
<div id="5d2d56a7" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN values with empty strings in the 'Comment Keywords' column</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment Keywords'</span>] <span class="op">=</span> df9[<span class="st">'Comment Keywords'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert `Comment Keywords` to string based on `Post Topic`</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>topic_minus1 <span class="op">=</span> df9.loc[df9[<span class="st">'Post Topic'</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="st">'Comment Keywords'</span>]</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>topic_minus1 <span class="op">=</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>.join(topic_minus1)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>topic_minus1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>'Vietnam, US troops, green flamed M62 tracers, Iraq, NATO, red tracers, Vietnam War, Warsaw Pact\nNo keywords, events, or characters related to Vietnamese History found in the text.\nNo keywords, events, or characters related to Vietnamese History were found in the given text.\nVietnamese History: None\nNo keywords, events, or characters related to Vietnamese History were found in the provided text.\nKeywords: besiegers, catapult, dead animals, sewage, walls\nKeywords: trebuchet, urinal\n- India\n- USA\n- Thailand\n- Philippines\nKeywords: Vietnamese History, information\nOperation Grommet\nThiệu, United States, military training, Command and General Staff College, Fort Leavenworth, Kansas, weapons training, Fort Bliss, Texas, Joint and Combined Planning School, Pacific Command, Okinawa.\nVietnamese History\ndivination purposes'</code></pre>
</div>
</div>
<p>I will repeat this for all of the <code>Post Topic</code>. Here are they keywords that I found. Thiệu (Former President of the Republic of Vietnam), Invasion of the South by the North (Sai Gon Fall), Nguyen Cao Ky, Gulf of Tonkin incident (event that started Vietnam War), guerrilla tactics, Indo China, France’s defeat and pulling out of Vietnam, Dien Bien Phu, Viet-Minh, Viet Cong, Ho Chi Minh, Indochina, Dien Bien Phu, Khmer Rouge, Pol Pot, Tet offensive, Geneva convention, Nixon, Ho Chi Minh trail, Agent Orange, John F. Kennedy, Chinese invasion of Vietnam, Diem.</p>
<p>These are some very interesting keywords. I will organize these keywords in a chronological order. I have coded a code to show different images and text if you hit next and previous, but quarto file does not seem to be able to run python libraries like <code>ipywidgets</code> that uses javascripts. For that, I will have to print out each of the image and its corresponding text.</p>
<p><strong>Code using <code>ipywidgets</code></strong></p>
<div id="14f992d8" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import ipywidgets as widgets</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># from IPython.display import display</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Define a list of image and captions</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># image = ['indochina.png', 'ho chi minh.png', 'first indochina war.png', '17 parallel.png', </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#          'viet cong.png', 'vietnam war.png', 'sai gon fall.png', 'agent orange.png', 'sino vietnam war.png']</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># title = ['Indochina', 'Ho Chi Minh', 'First Indochina War', 'The Geneva Accords', </span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#          'Viet Cong', 'Second Indochina War', 'Withdrawal of US troops and the war ends', 'Agent Orange', 'Sino-Vietnamese War']</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># caption = [</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Indochina is a term to mention countries between Indian and China. Those countries blend the unique cultures of the two giants into countries we know today as Vietnam, Laos, Cambodia, Thailand, Myanmar, and parts of Malaysia. These countries have a long history with many kingdoms rose and fell. The French popularize the terms after they established colonies in Vietnam, Laos and Cambodia. During WW2, the Japanese took advantage of the French when they were defeated by the NAZI German and occupied the region. However, after WW2, Japan surrendered to the Allied because of nuclear weapons, leading to a power vacuum the SEA (Southeast Asia). Seizing this opportunity, the French tried to regain control of the region, and this led to the First Indochina War. Source: https://kids.britannica.com/students/article/Indochina/275049', </span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#    'The leader of Democratic Republic of Vietnam (North Vietnam) from 1945 to 1969. He was one of the most influential communist leaders in the 20th century. He founded Viet Minh, an Vietnamese organization that fought the French rule and later the Americans. Source: https://www.britannica.com/biography/Ho-Chi-Minh', </span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    'In 1946, Ho Chi Minh and the French had some peace negotiations that recognize Vietnam as a free state within the French Union. Despite some initially cooperations, the tensions were still high, and the French intension was still clear that they wanted Vietnam to be a colony. In that same year, the French proclaimed Cochinchina (South Vietnam) as an autonomous republic and launched an attack in Hai Phong, the biggest port city in Northen Vietnam. That resulted in thousands of civilian casualties and sparked the beginning of the First Indochina War. In 1949, France reunited South Vietnam and appointed Bao Dai (former emperor of the Nguyen Dynasty) to the chief of state. However, most nationalists denounced Bao Dai leadership and the political in the South was in a state of struggles. The Americans, who feared for the Communist Domino Effect, supported the French with ammunition and money. But, with the fall of French garrison at Dien Bien Phu, which effectively ended the French Colony in Vietnam and led to the Geneva Conference. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence',</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     'The Geneva Accords in 1954 were signed by the Viet Minh and French that cease-fire and temporary divide the country into two at latitude 17 or 17th parallel. All military forces must withdraw, and the Vietnamese people were allowed to relocate between 2 countries for a limited time frame. The Final Declaration of the Accords states that an election needs to be held to unify the country but that never happened. During the mass migration from the North to South of around 1 million people, the two Vietnams began to reform their countries. The North, with the supports of China and Soviet Union, began to embark the program of socialist industrialization and collected agriculture. Whereas the South, Ngo Dinh Diem was appointed as a new president with the support of John F. Kennedy (president of America). Diem achieved this by removing Bao Dai in a government-controlled referendum. Diem, who was an anti-communist, showed obvious signs of dictatorship in his presidency. From consolidating power within his family, apply totalitarian methods to anyone who did not meet his eyes, show favoritism to Romon Catholics while alienated Buddhist in a Buddhism country. All of these ultimately led to his demise when the Viet Cong launched an insurgency movement which further destabilize the country, and when Diem’s general overthrew him, leading to his and his brother’s death. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence',</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Communist guerrilla force. A force that is separated but an ally of people’s army of Vietnam. Viet cong was the name given by President Ngo Dinh Diem to belittle the rebels. In the initial stage, Viet Cong is a collection of groups, but later in 1960, they merged into one with an official name of the National Liberation Front (NLF). Although the name changes, the main objective of the group was to overthrow the South Vietnamese government and reunify Vietnam. Source: https://www.britannica.com/topic/Viet-Cong',</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     'After the death of Ngo Dinh Diem, South Vietnam politics was in chaos, until in 1955, Nguyen Cao Ky who led the military to seized power. Although Ky faced opposition from Buddhists who overthrown Diem, he suppressed them. This oppressive regime did not change after the election of a new president Nguyen Van Thieu. The regime continues to suppress political freedoms and operate in a repressive framework. On the other hand, the North and the Viet Cong soldiers insurged South Vietnam from 1963 (Diem’s death) with 30,000 fighters to 150,000 in 1965. This caused the American to fear for the fall of Sai Gon. Fearing the thread of North Vietnam, the American supported the South regime with the addition of many advisers, and ammunitions, but it could not halt the advance of Northern Vietnam. After the Congress approve the for war in Vietnam after the Gulf of Tonkin incident, President Lyndon B. Johnson appointed 500,000 troops in Vietnam to fight along slide 600,000 South Vietnamese soldiers and the allied from South Korean, Thailand, Australia, and New Zealand. From 1965 to 1968 began the intensive bombing of the Americans to the North Vietnam. Despise that, it only strengthens the resilient of the PVA (People’s Army of Vietnam) and the Viet Cong to unify the country. Infiltration of personnel and supplies down the Ho Chi Minh Trail continued to increase with an estimation of more than 100,000 regular troops from the north. The evident of continuing strength became clear during the Tet Offensive where the North Vietnam attacked more than 100 cities and military bases. The offensive shocked the US public and a growing conviction to continue the war at the current level was unacceptable. This led to the negotiations in Paris in 1968 where the bombing halted but the war still continued. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65',</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     'The war still continued under the new US president Richard M. Nixon, but a peace treaty was signed in Paris. As mentioned on the maps, President Nixon had a policy of Vietnamization where he wanted to end the US involvement in the Vietnam War. In the peace treaty signed by the US and three parties in Vietnam (North Vietnam, South Vietnam, and Viet Cong), the US needed to leave Vietnam within 60 days and create a political process to resolute the conflict in the south. However, the peace talks did not mention anything about the 100,000 North Vietnamese soldiers stationed in the South, and so the civil war continued. In late 1974, North Vietnam launched a major offensive to the South, which caused the Sai Gon’s troops to be in disarray. President Thieu ordered to retreat the troops back the Sai Gon, but it was too late. On April 30, 1975, the South Vietnam emerged victorious and thus united the country. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65',</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     'Agent orange was an herbicide used by US during the Vietnam War. This herbicide contains a dangerous chemical called dioxin. The substance dioxin is highly contaminated and exposure to it can cause health issues such as cancers, diabetes, and birth defects. The Red Cross estimated that around 3 million Vietnamese have been affected by this dioxin and at least 150,000 children were born with severe birth defects. Until this day, there are still millions of Vietnamese and Americans are affected by Agent Orange. Additionally, in southern and central Vietnam, millions of acres of forest and farmland are defoliated by Agent Orange. Although Agent Orange was terminated by the US and there is no more Agent Orange chemical today, its impact is still there. Source: https://www.aspeninstitute.org/programs/agent-orange-in-vietnam-program/what-is-agent-orange/#:~:text=Agent%20Orange%20was%20a%20herbicide,to%20have%20harmful%20impact%20today.',</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     'This text is a copy from the map. Khmer Rouge, a terror regime led by Pol Pot which killed millions of Cambodians which sought Vietnam was their next target. After their defeats in 1977 where the Khmer Rouge killed 1000 Vietnamese, and Vietnam retaliated by launching several successful campaigns, the Khmer Rouge came back in 1978. In April of that year, they crossed the border and attacked Ba Chuc village. Only 12 days, they mass murdered 3000 Vietnamese and there were only 2 known survivors. These caused Vietnam to attack full force and capture Phnom Penh (the capital of Cambodia) in January of 1979, ending the Pol Pot regime. China, who supported the Khmer Rouge financial, feared the expansion of Vietnam, started a Sino-Vietnamese War which lasted for 27 days. Source: https://solotravellerontour.com/mekong-delta-border-loop-ba-chuc-tomb/',</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ]</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Initialize the current index (the first image)</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co"># current_index = 0</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function that updates the image and caption</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co"># def update(index):</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co">#     with open(image[index], 'rb') as f:</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co">#         image_data = f.read()</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co">#     image_widget.value = image_data</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     title_widget.value = title[index]</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     text_widget.value = caption[index]</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create image and text widgets</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="co"># image_widget = widgets.Image(</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     format='png',</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     width = 400,</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a><span class="co">#     height = 400</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co"># title_widget = widgets.Text(</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     layout=widgets.Layout(width='400px'),</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     style={'description_width': 'initial', 'font_weight': 'bold', 'font_size': '18px'}</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a><span class="co"># text_widget = widgets.Textarea(</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     layout=widgets.Layout(width='400px', height='200px'),</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     style={'description_width': 'initial', 'background': 'white', 'color': 'black', 'font_size': '14px'}</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a><span class="co"># # Initial display</span></span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a><span class="co"># update(current_index)</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function to handle button clicks</span></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a><span class="co"># def button_on_click(button): </span></span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     global current_index</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     if button.description == 'Previous': # previous image</span></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a><span class="co">#         current_index = (current_index - 1) % len(image)</span></span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     elif button.description == 'Next': # next image</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a><span class="co">#         current_index = (current_index + 1) % len(image)</span></span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     update(current_index) # update the current image</span></span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create buttons</span></span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a><span class="co"># previous_button = widgets.Button(description="Previous")</span></span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a><span class="co"># next_button = widgets.Button(description="Next")</span></span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a><span class="co"># # Assign button click to event handlers</span></span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a><span class="co"># previous_button.on_click(button_on_click)</span></span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a><span class="co"># next_button.on_click(button_on_click)</span></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # Display everything vertically</span></span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a><span class="co"># box = widgets.VBox([image_widget, title_widget, text_widget, widgets.HBox([previous_button, next_button])])</span></span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a><span class="co"># display(box)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Code does not use <code>ipywidgets</code></strong></p>
<div id="2d6d5e20" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a list of images and captions</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>image_url <span class="op">=</span> [<span class="st">'https://www.indochinatour.com/assets/images/indochina-tour/indochina-region-outline-5.png'</span>, <span class="st">'https://assets.editorial.aetnd.com/uploads/2010/07/ho-chi-minh-2.jpg'</span>, <span class="st">'https://upload.wikimedia.org/wikipedia/commons/3/33/First_Indochina_War_COLLAGE.jpg'</span>, <span class="st">'https://www.researchgate.net/profile/Phearak-Kruy/publication/364030812/figure/fig5/AS:11431281087288605@1664539088821/17th-Parallel-dividing-North-Vietnam-and-South-Vietnam.jpg'</span>, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">'https://cdn.britannica.com/42/142842-050-83690FAB/soldier-bunker-Viet-Cong-Vietnam-War.jpg'</span>, <span class="st">'https://cdn.theatlantic.com/media/img/photo/2015/03/the-vietnam-war-part-i-early-years/v01_AP6503010453-1/original.jpg'</span>, <span class="st">'https://upload.wikimedia.org/wikipedia/en/9/95/Saigon-hubert-van-es.jpg'</span>, <span class="st">'https://upload.wikimedia.org/wikipedia/commons/1/1f/US-Huey-helicopter-spraying-Agent-Orange-in-Vietnam.jpg'</span>, <span class="st">'https://upload.wikimedia.org/wikipedia/commons/7/74/Vietnam_china.jpg'</span>]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> [<span class="st">'Indochina'</span>, <span class="st">'Ho Chi Minh'</span>, <span class="st">'First Indochina War'</span>, <span class="st">'The Geneva Accords'</span>, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">'Viet Cong'</span>, <span class="st">'Second Indochina War'</span>, <span class="st">'Withdrawal of US troops and the war ends'</span>, <span class="st">'Agent Orange'</span>, <span class="st">'Sino-Vietnamese War'</span>]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>caption <span class="op">=</span> [</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Indochina is a term to mention countries between Indian and China. Those countries blend the unique cultures of the two giants into countries we know today as Vietnam, Laos, Cambodia, Thailand, Myanmar, and parts of Malaysia. These countries have a long history with many kingdoms rose and fell. The French popularize the terms after they established colonies in Vietnam, Laos and Cambodia. During WW2, the Japanese took advantage of the French when they were defeated by the NAZI German and occupied the region. However, after WW2, Japan surrendered to the Allied because of nuclear weapons, leading to a power vacuum the SEA (Southeast Asia). Seizing this opportunity, the French tried to regain control of the region, and this led to the First Indochina War. Source: https://kids.britannica.com/students/article/Indochina/275049'</span>, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>   <span class="st">'The leader of Democratic Republic of Vietnam (North Vietnam) from 1945 to 1969. He was one of the most influential communist leaders in the 20th century. He founded Viet Minh, an Vietnamese organization that fought the French rule and later the Americans. Source: https://www.britannica.com/biography/Ho-Chi-Minh'</span>, </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>   <span class="st">'In 1946, Ho Chi Minh and the French had some peace negotiations that recognize Vietnam as a free state within the French Union. Despite some initially cooperations, the tensions were still high, and the French intension was still clear that they wanted Vietnam to be a colony. In that same year, the French proclaimed Cochinchina (South Vietnam) as an autonomous republic and launched an attack in Hai Phong, the biggest port city in Northen Vietnam. That resulted in thousands of civilian casualties and sparked the beginning of the First Indochina War. In 1949, France reunited South Vietnam and appointed Bao Dai (former emperor of the Nguyen Dynasty) to the chief of state. However, most nationalists denounced Bao Dai leadership and the political in the South was in a state of struggles. The Americans, who feared for the Communist Domino Effect, supported the French with ammunition and money. But, with the fall of French garrison at Dien Bien Phu, which effectively ended the French Colony in Vietnam and led to the Geneva Conference. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence'</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The Geneva Accords in 1954 were signed by the Viet Minh and French that cease-fire and temporary divide the country into two at latitude 17 or 17th parallel. All military forces must withdraw, and the Vietnamese people were allowed to relocate between 2 countries for a limited time frame. The Final Declaration of the Accords states that an election needs to be held to unify the country but that never happened. During the mass migration from the North to South of around 1 million people, the two Vietnams began to reform their countries. The North, with the supports of China and Soviet Union, began to embark the program of socialist industrialization and collected agriculture. Whereas the South, Ngo Dinh Diem was appointed as a new president with the support of John F. Kennedy (president of America). Diem achieved this by removing Bao Dai in a government-controlled referendum. Diem, who was an anti-communist, showed obvious signs of dictatorship in his presidency. From consolidating power within his family, apply totalitarian methods to anyone who did not meet his eyes, show favoritism to Romon Catholics while alienated Buddhist in a Buddhism country. All of these ultimately led to his demise when the Viet Cong launched an insurgency movement which further destabilize the country, and when Diem’s general overthrew him, leading to his and his brother’s death. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence'</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Communist guerrilla force. A force that is separated but an ally of people’s army of Vietnam. Viet cong was the name given by President Ngo Dinh Diem to belittle the rebels. In the initial stage, Viet Cong is a collection of groups, but later in 1960, they merged into one with an official name of the National Liberation Front (NLF). Although the name changes, the main objective of the group was to overthrow the South Vietnamese government and reunify Vietnam. Source: https://www.britannica.com/topic/Viet-Cong'</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'After the death of Ngo Dinh Diem, South Vietnam politics was in chaos, until in 1955, Nguyen Cao Ky who led the military to seized power. Although Ky faced opposition from Buddhists who overthrown Diem, he suppressed them. This oppressive regime did not change after the election of a new president Nguyen Van Thieu. The regime continues to suppress political freedoms and operate in a repressive framework. On the other hand, the North and the Viet Cong soldiers insurged South Vietnam from 1963 (Diem’s death) with 30,000 fighters to 150,000 in 1965. This caused the American to fear for the fall of Sai Gon. Fearing the thread of North Vietnam, the American supported the South regime with the addition of many advisers, and ammunitions, but it could not halt the advance of Northern Vietnam. After the Congress approve the for war in Vietnam after the Gulf of Tonkin incident, President Lyndon B. Johnson appointed 500,000 troops in Vietnam to fight along slide 600,000 South Vietnamese soldiers and the allied from South Korean, Thailand, Australia, and New Zealand. From 1965 to 1968 began the intensive bombing of the Americans to the North Vietnam. Despise that, it only strengthens the resilient of the PVA (People’s Army of Vietnam) and the Viet Cong to unify the country. Infiltration of personnel and supplies down the Ho Chi Minh Trail continued to increase with an estimation of more than 100,000 regular troops from the north. The evident of continuing strength became clear during the Tet Offensive where the North Vietnam attacked more than 100 cities and military bases. The offensive shocked the US public and a growing conviction to continue the war at the current level was unacceptable. This led to the negotiations in Paris in 1968 where the bombing halted but the war still continued. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65'</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'The war still continued under the new US president Richard M. Nixon, but a peace treaty was signed in Paris. As mentioned on the maps, President Nixon had a policy of Vietnamization where he wanted to end the US involvement in the Vietnam War. In the peace treaty signed by the US and three parties in Vietnam (North Vietnam, South Vietnam, and Viet Cong), the US needed to leave Vietnam within 60 days and create a political process to resolute the conflict in the south. However, the peace talks did not mention anything about the 100,000 North Vietnamese soldiers stationed in the South, and so the civil war continued. In late 1974, North Vietnam launched a major offensive to the South, which caused the Sai Gon’s troops to be in disarray. President Thieu ordered to retreat the troops back the Sai Gon, but it was too late. On April 30, 1975, the South Vietnam emerged victorious and thus united the country. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65'</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Agent orange was an herbicide used by US during the Vietnam War. This herbicide contains a dangerous chemical called dioxin. The substance dioxin is highly contaminated and exposure to it can cause health issues such as cancers, diabetes, and birth defects. The Red Cross estimated that around 3 million Vietnamese have been affected by this dioxin and at least 150,000 children were born with severe birth defects. Until this day, there are still millions of Vietnamese and Americans are affected by Agent Orange. Additionally, in southern and central Vietnam, millions of acres of forest and farmland are defoliated by Agent Orange. Although Agent Orange was terminated by the US and there is no more Agent Orange chemical today, its impact is still there. Source: https://www.aspeninstitute.org/programs/agent-orange-in-vietnam-program/what-is-agent-orange/#:~:text=Agent%20Orange%20was%20a</span><span class="sc">%20he</span><span class="st">rbicide,to%20have%20harmful</span><span class="sc">%20i</span><span class="st">mpact%20today.'</span>,</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'This text is a copy from the map. Khmer Rouge, a terror regime led by Pol Pot which killed millions of Cambodians which sought Vietnam was their next target. After their defeats in 1977 where the Khmer Rouge killed 1000 Vietnamese, and Vietnam retaliated by launching several successful campaigns, the Khmer Rouge came back in 1978. In April of that year, they crossed the border and attacked Ba Chuc village. Only 12 days, they mass murdered 3000 Vietnamese and there were only 2 known survivors. These caused Vietnam to attack full force and capture Phnom Penh (the capital of Cambodia) in January of 1979, ending the Pol Pot regime. China, who supported the Khmer Rouge financial, feared the expansion of Vietnam, started a Sino-Vietnamese War which lasted for 27 days. Source: https://solotravellerontour.com/mekong-delta-border-loop-ba-chuc-tomb/'</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the current index (the first image)</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Function that updates the image and caption</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(index):</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    clear_output(wait<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display the image</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    display(HTML(<span class="ss">f'&lt;img src="</span><span class="sc">{</span>image_url[index]<span class="sc">}</span><span class="ss">" width="400" height="400"&gt;'</span>))</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    display(HTML(<span class="ss">f'&lt;h3&gt;</span><span class="sc">{</span>title[index]<span class="sc">}</span><span class="ss">&lt;/h3&gt;'</span>))</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    display(HTML(<span class="ss">f'&lt;p&gt;</span><span class="sc">{</span>caption[index]<span class="sc">}</span><span class="ss">&lt;/p&gt;'</span>))</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display initial image and caption</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://www.indochinatour.com/assets/images/indochina-tour/indochina-region-outline-5.png" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Indochina</h3>
</div>
<div class="cell-output cell-output-display">
<p>Indochina is a term to mention countries between Indian and China. Those countries blend the unique cultures of the two giants into countries we know today as Vietnam, Laos, Cambodia, Thailand, Myanmar, and parts of Malaysia. These countries have a long history with many kingdoms rose and fell. The French popularize the terms after they established colonies in Vietnam, Laos and Cambodia. During WW2, the Japanese took advantage of the French when they were defeated by the NAZI German and occupied the region. However, after WW2, Japan surrendered to the Allied because of nuclear weapons, leading to a power vacuum the SEA (Southeast Asia). Seizing this opportunity, the French tried to regain control of the region, and this led to the First Indochina War. Source: https://kids.britannica.com/students/article/Indochina/275049</p>
</div>
</div>
<div id="8b4d6d4b" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://assets.editorial.aetnd.com/uploads/2010/07/ho-chi-minh-2.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Ho Chi Minh</h3>
</div>
<div class="cell-output cell-output-display">
<p>The leader of Democratic Republic of Vietnam (North Vietnam) from 1945 to 1969. He was one of the most influential communist leaders in the 20th century. He founded Viet Minh, an Vietnamese organization that fought the French rule and later the Americans. Source: https://www.britannica.com/biography/Ho-Chi-Minh</p>
</div>
</div>
<div id="c3ea601e" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://upload.wikimedia.org/wikipedia/commons/3/33/First_Indochina_War_COLLAGE.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">First Indochina War</h3>
</div>
<div class="cell-output cell-output-display">
<p>In 1946, Ho Chi Minh and the French had some peace negotiations that recognize Vietnam as a free state within the French Union. Despite some initially cooperations, the tensions were still high, and the French intension was still clear that they wanted Vietnam to be a colony. In that same year, the French proclaimed Cochinchina (South Vietnam) as an autonomous republic and launched an attack in Hai Phong, the biggest port city in Northen Vietnam. That resulted in thousands of civilian casualties and sparked the beginning of the First Indochina War. In 1949, France reunited South Vietnam and appointed Bao Dai (former emperor of the Nguyen Dynasty) to the chief of state. However, most nationalists denounced Bao Dai leadership and the political in the South was in a state of struggles. The Americans, who feared for the Communist Domino Effect, supported the French with ammunition and money. But, with the fall of French garrison at Dien Bien Phu, which effectively ended the French Colony in Vietnam and led to the Geneva Conference. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence</p>
</div>
</div>
<div id="ac35d7f4" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://www.researchgate.net/profile/Phearak-Kruy/publication/364030812/figure/fig5/AS:11431281087288605@1664539088821/17th-Parallel-dividing-North-Vietnam-and-South-Vietnam.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">The Geneva Accords</h3>
</div>
<div class="cell-output cell-output-display">
<p>The Geneva Accords in 1954 were signed by the Viet Minh and French that cease-fire and temporary divide the country into two at latitude 17 or 17th parallel. All military forces must withdraw, and the Vietnamese people were allowed to relocate between 2 countries for a limited time frame. The Final Declaration of the Accords states that an election needs to be held to unify the country but that never happened. During the mass migration from the North to South of around 1 million people, the two Vietnams began to reform their countries. The North, with the supports of China and Soviet Union, began to embark the program of socialist industrialization and collected agriculture. Whereas the South, Ngo Dinh Diem was appointed as a new president with the support of John F. Kennedy (president of America). Diem achieved this by removing Bao Dai in a government-controlled referendum. Diem, who was an anti-communist, showed obvious signs of dictatorship in his presidency. From consolidating power within his family, apply totalitarian methods to anyone who did not meet his eyes, show favoritism to Romon Catholics while alienated Buddhist in a Buddhism country. All of these ultimately led to his demise when the Viet Cong launched an insurgency movement which further destabilize the country, and when Diem’s general overthrew him, leading to his and his brother’s death. Source: https://www.britannica.com/place/Vietnam/World-War-II-and-independence</p>
</div>
</div>
<div id="1f5b64aa" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://cdn.britannica.com/42/142842-050-83690FAB/soldier-bunker-Viet-Cong-Vietnam-War.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Viet Cong</h3>
</div>
<div class="cell-output cell-output-display">
<p>Communist guerrilla force. A force that is separated but an ally of people’s army of Vietnam. Viet cong was the name given by President Ngo Dinh Diem to belittle the rebels. In the initial stage, Viet Cong is a collection of groups, but later in 1960, they merged into one with an official name of the National Liberation Front (NLF). Although the name changes, the main objective of the group was to overthrow the South Vietnamese government and reunify Vietnam. Source: https://www.britannica.com/topic/Viet-Cong</p>
</div>
</div>
<div id="db1dfefa" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://cdn.theatlantic.com/media/img/photo/2015/03/the-vietnam-war-part-i-early-years/v01_AP6503010453-1/original.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Second Indochina War</h3>
</div>
<div class="cell-output cell-output-display">
<p>After the death of Ngo Dinh Diem, South Vietnam politics was in chaos, until in 1955, Nguyen Cao Ky who led the military to seized power. Although Ky faced opposition from Buddhists who overthrown Diem, he suppressed them. This oppressive regime did not change after the election of a new president Nguyen Van Thieu. The regime continues to suppress political freedoms and operate in a repressive framework. On the other hand, the North and the Viet Cong soldiers insurged South Vietnam from 1963 (Diem’s death) with 30,000 fighters to 150,000 in 1965. This caused the American to fear for the fall of Sai Gon. Fearing the thread of North Vietnam, the American supported the South regime with the addition of many advisers, and ammunitions, but it could not halt the advance of Northern Vietnam. After the Congress approve the for war in Vietnam after the Gulf of Tonkin incident, President Lyndon B. Johnson appointed 500,000 troops in Vietnam to fight along slide 600,000 South Vietnamese soldiers and the allied from South Korean, Thailand, Australia, and New Zealand. From 1965 to 1968 began the intensive bombing of the Americans to the North Vietnam. Despise that, it only strengthens the resilient of the PVA (People’s Army of Vietnam) and the Viet Cong to unify the country. Infiltration of personnel and supplies down the Ho Chi Minh Trail continued to increase with an estimation of more than 100,000 regular troops from the north. The evident of continuing strength became clear during the Tet Offensive where the North Vietnam attacked more than 100 cities and military bases. The offensive shocked the US public and a growing conviction to continue the war at the current level was unacceptable. This led to the negotiations in Paris in 1968 where the bombing halted but the war still continued. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65</p>
</div>
</div>
<div id="040998bc" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://upload.wikimedia.org/wikipedia/en/9/95/Saigon-hubert-van-es.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Withdrawal of US troops and the war ends</h3>
</div>
<div class="cell-output cell-output-display">
<p>The war still continued under the new US president Richard M. Nixon, but a peace treaty was signed in Paris. As mentioned on the maps, President Nixon had a policy of Vietnamization where he wanted to end the US involvement in the Vietnam War. In the peace treaty signed by the US and three parties in Vietnam (North Vietnam, South Vietnam, and Viet Cong), the US needed to leave Vietnam within 60 days and create a political process to resolute the conflict in the south. However, the peace talks did not mention anything about the 100,000 North Vietnamese soldiers stationed in the South, and so the civil war continued. In late 1974, North Vietnam launched a major offensive to the South, which caused the Sai Gon’s troops to be in disarray. President Thieu ordered to retreat the troops back the Sai Gon, but it was too late. On April 30, 1975, the South Vietnam emerged victorious and thus united the country. Source: https://www.britannica.com/place/Vietnam/The-two-Vietnams-1954-65</p>
</div>
</div>
<div id="01600838" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://upload.wikimedia.org/wikipedia/commons/1/1f/US-Huey-helicopter-spraying-Agent-Orange-in-Vietnam.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Agent Orange</h3>
</div>
<div class="cell-output cell-output-display">
<p>Agent orange was an herbicide used by US during the Vietnam War. This herbicide contains a dangerous chemical called dioxin. The substance dioxin is highly contaminated and exposure to it can cause health issues such as cancers, diabetes, and birth defects. The Red Cross estimated that around 3 million Vietnamese have been affected by this dioxin and at least 150,000 children were born with severe birth defects. Until this day, there are still millions of Vietnamese and Americans are affected by Agent Orange. Additionally, in southern and central Vietnam, millions of acres of forest and farmland are defoliated by Agent Orange. Although Agent Orange was terminated by the US and there is no more Agent Orange chemical today, its impact is still there. Source: https://www.aspeninstitute.org/programs/agent-orange-in-vietnam-program/what-is-agent-orange/#:~:text=Agent%20Orange%20was%20a%20herbicide,to%20have%20harmful%20impact%20today.</p>
</div>
</div>
<div id="f2990398" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>current_index <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>update(current_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<img src="https://upload.wikimedia.org/wikipedia/commons/7/74/Vietnam_china.jpg" width="400" height="400">
</div>
<div class="cell-output cell-output-display">
<h3 class="anchored">Sino-Vietnamese War</h3>
</div>
<div class="cell-output cell-output-display">
<p>This text is a copy from the map. Khmer Rouge, a terror regime led by Pol Pot which killed millions of Cambodians which sought Vietnam was their next target. After their defeats in 1977 where the Khmer Rouge killed 1000 Vietnamese, and Vietnam retaliated by launching several successful campaigns, the Khmer Rouge came back in 1978. In April of that year, they crossed the border and attacked Ba Chuc village. Only 12 days, they mass murdered 3000 Vietnamese and there were only 2 known survivors. These caused Vietnam to attack full force and capture Phnom Penh (the capital of Cambodia) in January of 1979, ending the Pol Pot regime. China, who supported the Khmer Rouge financial, feared the expansion of Vietnam, started a Sino-Vietnamese War which lasted for 27 days. Source: https://solotravellerontour.com/mekong-delta-border-loop-ba-chuc-tomb/</p>
</div>
</div>
<p>In this section, I have used the keywords from the comments and provided a summary based on each of the keywords on the Vietnamese History, more specifically on the events leading up to the Vietnam War, the Vietnam War, and what happened after it.</p>
</section>
<section id="emotion-detection-in-comments" class="level2">
<h2 class="anchored" data-anchor-id="emotion-detection-in-comments">Emotion detection in <code>Comments</code></h2>
<p>Theses part is similar to the emotion detection in <code>Post</code></p>
<section id="split-the-post-into-chunk-1" class="level4">
<h4 class="anchored" data-anchor-id="split-the-post-into-chunk-1">Split the post into chunk</h4>
<div id="585dfd17" class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NaN values with empty strings</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment3'</span>] <span class="op">=</span> df9[<span class="st">'Comment3'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'Comment'</span>] <span class="op">=</span> df9[<span class="st">'Comment'</span>].fillna(<span class="st">''</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to split text into token-length constrained chunks</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_text(text, tokenizer, max_length):</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tokenize text in form of pytorch tensors, truncation enabled and max length set</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> tokenizer(text, return_tensors<span class="op">=</span><span class="st">'pt'</span>, truncation<span class="op">=</span><span class="va">True</span>, max_length<span class="op">=</span>max_length)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the tokenized representation of the text</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    input_ids <span class="op">=</span> tokens[<span class="st">'input_ids'</span>][<span class="dv">0</span>].tolist()</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over input IDs in chunks of size `max_length`</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(input_ids), max_length):</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get a chunk of input IDs of length 'max_length'</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        chunk_ids <span class="op">=</span> input_ids[i:i <span class="op">+</span> max_length]</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Decode the chunk of input IDs back to text</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        chunk_text <span class="op">=</span> tokenizer.decode(chunk_ids, skip_special_tokens<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Yield the chunk of text</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> chunk_text</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Example use case</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="dv">512</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>chunks <span class="op">=</span> <span class="bu">list</span>(split_text(df9.Comment3[<span class="dv">1</span>], tokenizer, max_length)) <span class="co"># use `split_text` function to split text into chunks</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, chunk <span class="kw">in</span> <span class="bu">enumerate</span>(chunks):</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Chunk </span><span class="sc">{</span>index <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>chunk<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Chunk 1 the South be invade in a regular war by the North.</code></pre>
</div>
</div>
<p>The main function of the code block is to split the text from the comment column into smaller token-length chunks. This is a necessary process as our model has a limitation on input sequence length.</p>
</section>
<section id="get-the-emotion-of-each-comment" class="level4">
<h4 class="anchored" data-anchor-id="get-the-emotion-of-each-comment">Get the emotion of each comment</h4>
<div id="c7252ce6" class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get the dominant emotion from the a text</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_emotion(text):</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    max_length <span class="op">=</span> <span class="dv">512</span> <span class="co"># Max token length of the Roberta model</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    emotions <span class="op">=</span> []</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use `split_text` function to split text into chunks</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chunk <span class="kw">in</span> split_text(text, tokenizer, max_length):</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Predict emotion for the current chunk</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> emotionModel(chunk)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the predicted emotion label to the `emotions` list</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>        emotions.append(result[<span class="dv">0</span>][<span class="st">'label'</span>])</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the most frequence emotions in the emotion list for that text</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> emotions:</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">max</span>(<span class="bu">set</span>(emotions), key<span class="op">=</span>emotions.count)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'neutral'</span> <span class="co"># return neutral of no emotion is found</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to the `Post` column</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>df9[<span class="st">'CommentEmotion'</span>] <span class="op">=</span> df9[<span class="st">'Comment3'</span>].<span class="bu">apply</span>(get_emotion)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove comment emotion if the comment is empty</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>df9.loc[df9.Comment3 <span class="op">==</span> <span class="st">''</span>, <span class="st">'CommentEmotion'</span>] <span class="op">=</span> <span class="st">'neutral'</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>df9.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post3</th>
<th data-quarto-table-cell-role="th">PostEmotion</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">Comment2</th>
<th data-quarto-table-cell-role="th">Comment3</th>
<th data-quarto-table-cell-role="th">Comment Keywords</th>
<th data-quarto-table-cell-role="th">CommentEmotion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>229</td>
<td>what happen in the aftermath of the Tet offens...</td>
<td>anticipation</td>
<td></td>
<td>NaN</td>
<td></td>
<td>Vietnamese History</td>
<td>neutral</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>anticipation</td>
<td>The South was invaded in a regular war by the ...</td>
<td>South invaded regular war North</td>
<td>the South be invade in a regular war by the No...</td>
<td>Keywords: South, North, war, invasion\n\nEvent...</td>
<td>fear</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>991</td>
<td>South Vietnam be help by US . even when the US...</td>
<td>anticipation</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>Ill forego lengthy analysis simply recommend b...</td>
<td>I will forego a lengthy analysis and simply re...</td>
<td>Keywords: Viet Nam, Nguyen Cao Ky, war</td>
<td>anticipation</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>1466</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>disgust</td>
<td>Did you actually try to find some answer yours...</td>
<td>actually try find answer asking</td>
<td>do you actually try to find some answer yourse...</td>
<td>No keywords, events, or characters related to ...</td>
<td>anticipation</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>1466</td>
<td>after WWII France be in rebuild mode , and yet...</td>
<td>disgust</td>
<td>I did some searching, but as far as I could fi...</td>
<td>searching far could find French interested rec...</td>
<td>I do some searching , but as far as I could fi...</td>
<td>Keywords: French, political, economic factors,...</td>
<td>anticipation</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>The code block returns a most prominent emotion detected based on the given text from the <code>split_text</code> function. Then it find the most frequence emotions of that comment and set it as the overall emotion of the comment.</p>
</section>
<section id="look-for-the-most-prominent-emotion-1" class="level3">
<h3 class="anchored" data-anchor-id="look-for-the-most-prominent-emotion-1">Look for the most prominent emotion</h3>
<div id="b6218fa8" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each emotions </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>emotion_counts <span class="op">=</span> df9[<span class="st">'CommentEmotion'</span>].value_counts() </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">6</span>))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>emotion_counts.index, y<span class="op">=</span>emotion_counts.values, palette<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add titles and labels</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Counts of Different Emotions in Comments'</span>)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Emotion'</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Count'</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="final_files/figure-html/cell-52-output-1.png" width="742" height="523" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The comment emotions distribution is quite similar to the post. As most of the comments are about war topic, and there are many unanswered questions leading to the feeling of anticipation. Negative emotions such as disgust, sadness and anger are also prominent. Like already mentioned, most of the topic about Vietnam History is about war, and war triggered many negative feelings.</p>
</section>
</section>
<section id="final-table-of-post-and-comment-deep-analysis" class="level2">
<h2 class="anchored" data-anchor-id="final-table-of-post-and-comment-deep-analysis">Final table of post and comment deep analysis</h2>
<section id="rearrange-columns" class="level3">
<h3 class="anchored" data-anchor-id="rearrange-columns">Rearrange columns</h3>
<div id="8ec29519" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df10 <span class="op">=</span> df9.drop([<span class="st">'Comment2'</span>, <span class="st">'Comment3'</span>, <span class="st">'Post3'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>df10 <span class="op">=</span> df10.reindex(columns<span class="op">=</span>[<span class="st">'PostId'</span>, <span class="st">'Post Topic'</span>, <span class="st">'Original Post'</span>, <span class="st">'OpenAI Post Summary'</span>, </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'OpenAI Post Label'</span>, <span class="st">'KeyBERT Post Label'</span>,  </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'PostEmotion'</span>, <span class="st">'Comment'</span>, <span class="st">'Comment Keywords'</span>, <span class="st">'CommentEmotion'</span>])</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>df10.rename({<span class="st">'PostEmotion'</span>: <span class="st">'Post Emotion'</span>, <span class="st">'CommentEmotion'</span>: <span class="st">'Comment Emotion'</span>}, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>df10.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PostId</th>
<th data-quarto-table-cell-role="th">Post Topic</th>
<th data-quarto-table-cell-role="th">Original Post</th>
<th data-quarto-table-cell-role="th">OpenAI Post Summary</th>
<th data-quarto-table-cell-role="th">OpenAI Post Label</th>
<th data-quarto-table-cell-role="th">KeyBERT Post Label</th>
<th data-quarto-table-cell-role="th">Post Emotion</th>
<th data-quarto-table-cell-role="th">Comment</th>
<th data-quarto-table-cell-role="th">Comment Keywords</th>
<th data-quarto-table-cell-role="th">Comment Emotion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>229</td>
<td>0</td>
<td>What happened in the aftermath of the Tet offe...</td>
<td>What happened to the Viet Cong after the Tet O...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>anticipation</td>
<td></td>
<td>Vietnamese History</td>
<td>neutral</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>991</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>anticipation</td>
<td>The South was invaded in a regular war by the ...</td>
<td>Keywords: South, North, war, invasion\n\nEvent...</td>
<td>fear</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>991</td>
<td>0</td>
<td>South Vietnam was helped by US. Even when the ...</td>
<td>Despite having strong support from the US and ...</td>
<td>['Chinese military support in wars']</td>
<td>['vietnam', 'vietnamese', 'indochina', 'troops...</td>
<td>anticipation</td>
<td>I'll forego a lengthy analysis and simply reco...</td>
<td>Keywords: Viet Nam, Nguyen Cao Ky, war</td>
<td>anticipation</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1466</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>disgust</td>
<td>Did you actually try to find some answer yours...</td>
<td>No keywords, events, or characters related to ...</td>
<td>anticipation</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1466</td>
<td>4</td>
<td>After WWII France was in rebuilding mode, and ...</td>
<td>Why did post-WWII France prioritize reclaiming...</td>
<td>["France's Post-WWII Indo-China Reclamation"]</td>
<td>['indochina', 'france', 'reclaiming', 'china',...</td>
<td>disgust</td>
<td>I did some searching, but as far as I could fi...</td>
<td>Keywords: French, political, economic factors,...</td>
<td>anticipation</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>This dataframe shows our deep analysis on the <code>Post</code> and <code>Comments</code>. It shows the <code>Post Topic</code> which is the Bertopic model categorizing the posts. <code>OpenAI Post Summary</code> is the summary generated to OpenAI. That couple with the <code>Original Post</code> column helped me to understand the overall theme of the posts. <code>OpenAI Post Label</code> and <code>KeyBERT Post Label</code> are the labelling of each topic from openai and keybert. The <code>Post Emotion</code> and <code>Comment Emotion</code> show the emotions for each post and comment. <code>Comment Keywords</code> is the column show casing the keywords of each comments, which help me to build an visualization on the chronological order of events happen prior, at and after the Vietnam War.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Here are the conclusion for the overall analysis and potential data privacy and ethics issues that arise during the my data analyzing process. First is the data preparation process where I convert the <code>xml</code> files from Stack Exchange to <code>csv</code> files. Then comes the data cleaning part. In the section, I will merge the different <code>csv</code> files together and use regexes along with other libraries to filter and clean my text columns. Next is the general analysis part where I look for the most common words in <code>Post</code> and <code>Comment</code> column. I also plot a time series graph on those most common words through out the years. After that, I need to perform a deeper analysis on the post and its corresponding comments. I first analyze the posts by using <code>OpenAI</code> and <code>Bertopic</code> to understand the overall theme and look out for different events and locations. These is crucial for plotting a Vietnam Map on different events happen during the Vietnamese History, more specifically the modern Vietnamese History and the location of the said event. I also apply <code>Emotion Detection</code> to identify the main emotions surrounding the posts. Second, I look at the comments. Since there are quite a lot of comments, I have gone for a different approach. I use <code>OpenAI</code> to return specific keywords and from those keywords, I have organized a chronological visualization on events surrouding those keywords. I also look for emotions surrounding each comments.</p>
<p>For the data privacy and ethics issues, I have some assumptions. Firstly, I was planning to use the <code>Users</code> dataset to plot a map of different users and their names to see who are interested in the Vietnam History and at what time. But, I feel like that is invading that person privacy and interest because I do not have their consent to use their information. I will just keep it as an anonymous QnA data. Also, I am a Vietnamese and analyzing different topics surrounding my country history. For that, I might be biased on my view towards certain topics. And Since this analysis is analyzing about war, meaning the context of its are sensitive, so different people of different origins may react differently while reading my analysis.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>